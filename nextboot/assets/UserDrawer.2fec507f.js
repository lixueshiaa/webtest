var O=Object.defineProperty,R=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var A=(s,o,r)=>o in s?O(s,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[o]=r,I=(s,o)=>{for(var r in o||(o={}))x.call(o,r)&&A(s,r,o[r]);if(D)for(var r of D(o))T.call(o,r)&&A(s,r,o[r]);return s},b=(s,o)=>R(s,j(o));var F=(s,o,r)=>new Promise((c,p)=>{var d=t=>{try{l(r.next(t))}catch(n){p(n)}},u=t=>{try{l(r.throw(t))}catch(n){p(n)}},l=t=>t.done?c(t.value):Promise.resolve(t.value).then(d,u);l((r=r.apply(s,o)).next())});import{B as C}from"./BasicForm.b84ad685.js";import"./componentMap.93bd7e90.js";import{u as L}from"./useForm.41e2e211.js";import"./RadioButtonGroup.7ea12308.js";import{z as w,dX as P,aF as S,aj as $,a as z,eW as G,j as i,f as K,o as V,k as N,G as X,p as q,ad as H}from"./index.d537950e.js";import"./JDictSelectTag.189304ea.js";import"./JUpload.864c8b30.js";import{f as J}from"./user.data.a28a217f.js";import{a as M,B as Q}from"./index.c1ddc319.js";import{a as Y,b as Z,s as ee}from"./user.api.dbd21046.js";import"./FormItem.vue_vue_type_script_lang.eed5af36.js";import"./index.991a4e0a.js";import"./BasicModal.5a168f1c.js";import"./useWindowSizeFn.5f6046fd.js";import"./index.52558c64.js";import"./useFormItem.6ac1e6ce.js";import"./download.bf76ecd3.js";import"./base64Conver.bb012c73.js";import"./index.41c7be8d.js";import"./index.9904d595.js";import"./useCountdown.ad6c5821.js";import"./api.c50f6281.js";import"./props.1eba571b.js";import"./Tree.vue_vue_type_style_index_0_lang.b76a1360.js";import"./useContextMenu.7a70fb68.js";import"./index.29969b1b.js";import"./onMountedOrActivated.b07d3039.js";import"./index.763820e1.js";import"./htmlmixed.285f9f73.js";import"./vue.80a2a3b3.js";import"./depart.api.c3d5b637.js";import"./index.64f1a493.js";import"./EditOutlined.6870e476.js";import"./functional.f108e49e.js";import"./validator.aea6ab50.js";const B={"<=565":"100%","<=1366":"800px","<=1600":"600px","<=1920":"600px",">1920":"500px"};function re(s=B,o=!0,r=50){const c=o?Object.assign({},B,s):s,p=Object.keys(c),d=w();function u(t){let n;for(const h of p)try{if(new Function(`return ${t} ${h}`)()){n=c[h];break}}catch(a){console.error(a)}n?d.value=n:console.warn("\u6CA1\u6709\u627E\u5230\u5339\u914D\u7684\u81EA\u9002\u5E94\u5BBD\u5EA6")}u(window.innerWidth);const{removeEvent:l}=P({el:window,name:"resize",listener:S(()=>u(window.innerWidth),r)});return $(()=>l()),{adaptiveWidth:d}}function oe(){return re({"<=620":"100%","<=1600":600,"<=1920":650,">1920":700},!1)}const Se=z({__name:"UserDrawer",emits:["success","register"],setup(s,{emit:o}){G();const r=w(!0),c=w(""),p=w([]),[d,{setProps:u,resetFields:l,setFieldsValue:t,validate:n,updateSchema:h}]=L({labelWidth:90,schemas:J,showActionButtonGroup:!1}),a=w(!0),[W,{setDrawerProps:v,closeDrawer:U}]=M(e=>F(this,null,function*(){var y;if(yield l(),a.value=(y=e==null?void 0:e.showFooter)!=null?y:!0,v({confirmLoading:!1,showFooter:a.value}),r.value=!!(e!=null&&e.isUpdate),i(r)){c.value=e.record.id,e.record.relTenantIds&&!Array.isArray(e.record.relTenantIds)?e.record.relTenantIds=e.record.relTenantIds.split(","):e.record.relTenantIds=[];try{const m=yield Y({userid:e.record.id});m&&m.length>0&&(e.record.selectedroles=m)}catch(m){}const f=yield Z({userId:e.record.id});if(f&&f.length>0){e.record.selecteddeparts=f;let m=Array.from(f,({key:g})=>g);e.record.selecteddeparts=m.join(","),p.value=f.map(g=>({label:g.title,value:g.key}))}e.record.departIds&&!Array.isArray(e.record.departIds)&&(e.record.departIds=e.record.departIds.split(",")),e.record.departIds=e.record.departIds==""?[]:e.record.departIds}e.selectedroles&&(yield t({selectedroles:e.selectedroles})),h([{field:"password",show:!i(r)},{field:"confirmPassword",ifShow:!i(r)},{field:"selectedroles",show:!e.isRole},{field:"departIds",componentProps:{options:p}},{field:"selecteddeparts",show:!(e!=null&&e.departDisabled)}]),typeof e.record=="object"&&t(I({},e.record)),u({disabled:e.action=="detail"})})),k=K(()=>i(r)?"\u7F16\u8F91\u7528\u6237":"\u65B0\u589E\u7528\u6237"),{adaptiveWidth:_}=oe();function E(){return F(this,null,function*(){try{let e=yield n();v({confirmLoading:!0}),e.userIdentity===1&&(e.departIds=""),yield ee(e,i(r)),U(),o("success",{isUpdate:i(r),values:b(I({},e),{id:c.value})})}finally{v({confirmLoading:!1})}})}return(e,y)=>(V(),N(i(Q),H(e.$attrs,{onRegister:i(W),title:i(k),width:i(_),onOk:E,showFooter:a.value,destroyOnClose:""}),{default:X(()=>[q(i(C),{onRegister:i(d)},null,8,["onRegister"])]),_:1},16,["onRegister","title","width","showFooter"]))}});export{Se as default};
