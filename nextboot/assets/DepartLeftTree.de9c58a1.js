var f=(l,m,i)=>new Promise((r,t)=>{var s=n=>{try{o(i.next(n))}catch(d){t(d)}},c=n=>{try{o(i.throw(n))}catch(d){t(d)}},o=n=>n.done?r(n.value):Promise.resolve(n.value).then(s,c);o((i=i.apply(l,m)).next())});import{a0 as x,a as q,b4 as F,z as u,U as p,o as _,k as D,G as T,p as C,i as N,l as O,N as P,an as K}from"./index.0c676cb0.js";import{s as z}from"./depart.user.api.a28dc42a.js";const b=l=>x.get({url:"/sys/sysDepart/queryDepartTreeSync",params:l}),I=l=>x.get({url:"/sys/user/queryByOrgCodeForAddressList",params:l}),M=l=>x.get({url:"/sys/position/list",params:l}),U=q({__name:"DepartLeftTree",emits:["select","rootTreeData"],setup(l,{expose:m,emit:i}){F("prefixCls");const r=u(!1),t=u([]),s=u([]),c=u([]),o=u(!1),n=u(null),d=u("");function g(){return f(this,null,function*(){try{r.value=!0,t.value=[];const e=yield b();Array.isArray(e)&&(t.value=e),s.value.length===0&&k()}finally{r.value=!1}})}g();function E(e){return f(this,null,function*(){try{const a=yield b({pid:e.dataRef.id});if(a.length==0)e.dataRef.isLeaf=!0;else if(e.dataRef.children=a,s.value.length>0){let y=[];for(let v of s.value)a.findIndex(h=>h.id===v)!==-1&&y.push(v);y.length>0&&(s.value=[...s.value])}t.value=[...t.value]}catch(a){console.error(a)}return Promise.resolve()})}function k(){let e=t.value[0];e&&(e.isLeaf||(s.value=[e.key]),L())}function L(){return f(this,null,function*(){yield K(),o.value=!0,yield K(),o.value=!1})}function w(e,a){c.value=[e],a&&(n.value=a,i("select",a))}function S(e){return f(this,null,function*(){if(e)try{r.value=!0,t.value=[];let a=yield z({keyWord:e});Array.isArray(a)&&(t.value=a),k()}finally{r.value=!1}else g();d.value=e})}function R(e,a){e.length>0&&c.value[0]!==e[0]?w(e[0],a.selectedNodes[0].props):w(c.value[0])}return m({loadRootTreeData:g}),(e,a)=>{const y=p("a-input-search"),v=p("a-tree"),h=p("a-empty"),A=p("a-spin"),B=p("a-card");return _(),D(B,{bordered:!1,style:{height:"100%"}},{default:T(()=>[C(A,{spinning:r.value},{default:T(()=>[C(y,{placeholder:"\u6309\u90E8\u95E8\u540D\u79F0\u641C\u7D22\u2026",style:{"margin-bottom":"10px"},onSearch:S,allowClear:""}),t.value.length>0?(_(),N(P,{key:0},[o.value?O("",!0):(_(),D(v,{key:0,showLine:"",clickRowToExpand:!1,treeData:t.value,selectedKeys:c.value,"load-data":E,expandedKeys:s.value,"onUpdate:expandedKeys":a[0]||(a[0]=j=>s.value=j),onSelect:R},null,8,["treeData","selectedKeys","expandedKeys"]))],64)):(_(),D(h,{key:1,description:"\u6682\u65E0\u6570\u636E"}))]),_:1},8,["spinning"])]),_:1})}}});var W=Object.freeze(Object.defineProperty({__proto__:null,default:U},Symbol.toStringTag,{value:"Module"}));export{W as D,U as _,I as l,M as p};
