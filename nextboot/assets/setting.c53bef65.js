var q=Object.defineProperty,K=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var N=(a,n,i)=>n in a?q(a,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[n]=i,I=(a,n)=>{for(var i in n||(n={}))R.call(n,i)&&N(a,i,n[i]);if(L)for(var i of L(n))W.call(n,i)&&N(a,i,n[i]);return a},O=(a,n)=>K(a,M(n));var z=(a,n,i)=>new Promise((e,_)=>{var x=f=>{try{k(i.next(f))}catch(b){_(b)}},U=f=>{try{k(i.throw(f))}catch(b){_(b)}},k=f=>f.done?e(f.value):Promise.resolve(f.value).then(x,U);k((i=i.apply(a,n)).next())});import{a1 as Y,a as Z,b9 as ee,B as te,z as se,X as ue,U as B,o as g,i as m,n as t,t as T,j as s,D as y,E,N as w,a9 as V,k as P,p as C,l as j,G as J,eA as le,J as G,fB as S,a0 as D,bP as oe,bQ as ae}from"./index.9eb451d3.js";import{J as A}from"./JDictSelectTag.3b1f5a5e.js";import"./useFormItem.b38dda7e.js";const d=a=>(oe("data-v-79c8bd75"),a=a(),ae(),a),ie={class:"setting"},ne=d(()=>t("div",{class:"card"},[t("div",{class:"left"},[t("span",{class:"tagStyle"}),t("span",{style:{"font-weight":"bold"}},"\u5F53\u524D\u4F7F\u7528\u7684\u6389\u516C\u89C4\u5219:")])],-1)),de={class:"edit"},re={class:"top"},ce=d(()=>t("span",{class:"title"},"\u6389\u516C\u5F00\u5173",-1)),pe={style:{"margin-left":"15px"}},ge={class:"editBottom"},fe=d(()=>t("div",{class:"change"}," \u9009\u62E9\u5C42\u7EA7\uFF1A ",-1)),_e={class:"tree"},he=d(()=>t("div",{style:{"margin-left":"20px"}}," \u6709\u6548\u671F\uFF1A ",-1)),ve={class:"date"},Ce=d(()=>t("span",{style:{"margin-left":"10px"}},"\u5929",-1)),Fe={class:"editBottom-first"},me=d(()=>t("div",null,"\u6700\u4F4E\u5C42",-1)),ye=d(()=>t("div",{style:{"margin-left":"8px"}}," \u9009\u62E9\u5C42\u7EA7\uFF1A ",-1)),Ee={class:"tree"},be={class:"setting",style:{"margin-top":"20px"}},ke={class:"card"},Be=d(()=>t("div",{class:"left"},[t("span",{class:"tagStyle"}),t("span",{style:{"font-weight":"bold"}},"\u672C\u7EA7\u6389\u516C\u8BBE\u7F6E")],-1)),Te={class:"right"},Pe=G("\u53D6\u6D88"),De=G("\u4FDD\u5B58"),Ae={class:"edit"},xe={class:"top"},Ue=d(()=>t("span",{class:"title"},"\u6389\u516C\u5F00\u5173",-1)),Ie=d(()=>t("span",{class:"hint"},"\u6CE8\uFF1A\u5F00\u542F\u540E\uFF0C\u6709\u6548\u671F\u65E0\u4EBA\u8DDF\u8FDB\u5219\u6389\u5165\u516C\u6C60",-1)),Oe={class:"editBottom"},we=d(()=>t("div",{class:"change"}," \u9009\u62E9\u5C42\u7EA7\uFF1A ",-1)),Se={class:"tree"},Le=d(()=>t("div",{style:{"margin-left":"20px"}}," \u6709\u6548\u671F\uFF1A ",-1)),Ne={class:"date"},ze=d(()=>t("span",{style:{"margin-left":"10px"}},"\u5929",-1)),Ve=["onClick"],je=d(()=>t("div",{class:"addbutton"},"+\u65B0\u589E\u5C42\u7EA7",-1)),Je=[je],Ge={class:"editBottom-first"},He=d(()=>t("div",null,"\u6700\u4F4E\u5C42",-1)),Qe=d(()=>t("div",{style:{"margin-left":"8px"}}," \u9009\u62E9\u5C42\u7EA7\uFF1A ",-1)),Xe={class:"tree"},$e=Z({__name:"setting",props:{data:{type:Object}},setup(a){const n=a,{hasPermission:i}=ee();let e=te({sysOrgId:"",isEdit:!1,checked:!1,currentChecked:!1,first:"\u79C1\u5BA2\u6C60",transferPublicConfig:[],currentTransferPublicConfig:[],unchangeChecked:!1,last:{},leftOrgId:""});const _=se([]),x=()=>{e.isEdit=!0},U=()=>{e.isEdit=!1,e.checked=e.unchangeChecked},k=()=>{if(!e.orgType){S.error("\u8BF7\u8BBE\u7F6E\u6700\u4F4E\u5C42");return}let l=[...e.transferPublicConfig];l.push(O(I({},e.last),{orgType:e.orgType})),l=l.map((v,o)=>O(I({},v),{orgLevel:o,orgConfigFlag:e.checked?1:0,validTime:Number(v.validTime),configLevel:"orgLevel",sysOrgId:e.leftOrgId}));let u=l.length-1,p=!1,r=!1;if(l.forEach((v,o)=>{o&&!v.orgType&&(p=!0),o!==u&&!v.validTime&&(r=!0)}),p){S.error("\u8BF7\u9009\u62E9\u5C42\u7EA7");return}if(r){S.error("\u8BF7\u8F93\u5165\u6709\u6548\u671F");return}console.log(l);let F={};F.transferPublicConfig=l,D.post({url:"/transferPublicController/edit",params:F}).then(v=>{e.isEdit=!1,b(e.leftOrgId),f(e.leftOrgId)})},f=l=>{_.value=[],D.post({url:"/transferPublicController/edit",params:{id:l}}).then(u=>{u.length&&u.map(p=>{_.value.push({label:p.label,value:p.value})})})},b=l=>{D.post({url:"/transferPublicController/edit",params:{sysOrgId:l}}).then(u=>{var p;if((p=u==null?void 0:u.records)!=null&&p.length){let r=u.records.find(F=>F.orgLevel=="0");e.checked=!!(r!=null&&r.orgConfigFlag),e.unchangeChecked=!!(r!=null&&r.orgConfigFlag),e.last=u==null?void 0:u.records[u.records.length-1],e.orgType=e.last.orgType,e.transferPublicConfig=u==null?void 0:u.records.splice(0,u.records.length-1)}else e.last={},e.checked=!1,e.orgType="1",e.transferPublicConfig=[{orgConfigFlag:0,validTime:30,orgLevel:0,orgType:""}];console.log(u,"\u6210\u529F"),H()})},H=()=>{e.checked?e.currentTransferPublicConfig=e.transferPublicConfig:Q()},Q=()=>z(this,null,function*(){D.post({url:"/transferPublicController/edit",params:{sysOrgId:e.leftOrgId}}).then(l=>{l!=null&&l.length?(e.currentTransferPublicConfig=l,e.currentTransferPublicConfig[0].orgConfigFlag==1?e.currentChecked=!0:e.currentChecked=!1):(e.currentTransferPublicConfig=[],e.currentChecked=!1)})}),X=()=>{e.transferPublicConfig.push({orgConfigFlag:0,validTime:30,orgLevel:"",orgType:""})},$=l=>{e.transferPublicConfig.splice(l,1)};return ue(()=>n.data,l=>{l&&(e.leftOrgId=l,f(l),b(l))},{deep:!0,immediate:!0}),(l,u)=>{const p=B("a-input"),r=B("a-input-number"),F=B("a-button"),v=B("a-switch");return g(),m(w,null,[t("div",ie,[ne,t("div",de,[t("div",re,[ce,t("span",pe,T(s(e).checked||s(e).currentChecked?"\u5F00\u542F":"\u5173\u95ED"),1)]),y(t("div",ge,[(g(!0),m(w,null,V(s(e).currentTransferPublicConfig.length===1?s(e).currentTransferPublicConfig:s(e).currentTransferPublicConfig.slice(0,-1),(o,h)=>(g(),m("div",{class:"editBottom-first",key:h},[t("div",null,"\u7B2C"+T(h)+"\u5C42",1),fe,t("div",_e,[h?(g(),P(A,{key:1,value:o.orgType,"onUpdate:value":c=>o.orgType=c,disabled:"",placeholder:"\u8BF7\u9009\u62E9\u7EC4\u7EC7\u7C7B\u578B",options:_.value,allowClear:""},null,8,["value","onUpdate:value","options"])):(g(),P(p,{key:0,disabled:"",value:s(e).first,"onUpdate:value":u[0]||(u[0]=c=>s(e).first=c)},null,8,["value"]))]),he,t("div",ve,[C(r,{value:o.validTime,"onUpdate:value":c=>o.validTime=c,disabled:"",placeholder:"\u8BF7\u8F93\u5165\u6B63\u6574\u6570",min:1},null,8,["value","onUpdate:value"]),Ce])]))),128)),t("div",Fe,[me,ye,t("div",Ee,[C(A,{value:s(e).orgType,"onUpdate:value":u[1]||(u[1]=o=>s(e).orgType=o),placeholder:"\u8BF7\u9009\u62E9\u7EC4\u7EC7\u7C7B\u578B",options:_.value,allowClear:"",disabled:""},null,8,["value","options"])])])],512),[[E,s(e).checked||s(e).currentChecked]])])]),t("div",be,[t("div",ke,[Be,s(i)("customerConfig:edit")?y((g(),m("div",{key:0,class:"right",onClick:x},"\u7F16\u8F91 ",512)),[[E,!s(e).isEdit]]):j("",!0),y(t("div",Te,[C(F,{type:"primary",size:"small",onClick:U},{default:J(()=>[Pe]),_:1}),C(F,{type:"primary",size:"small",onClick:k},{default:J(()=>[De]),_:1})],512),[[E,s(e).isEdit]])]),t("div",Ae,[t("div",xe,[Ue,y(C(v,{class:"switch",checked:s(e).checked,"onUpdate:checked":u[2]||(u[2]=o=>s(e).checked=o)},null,8,["checked"]),[[E,s(e).isEdit]]),y(t("span",{style:{"margin-left":"15px"}},T(s(e).checked?"\u5F00\u542F":"\u5173\u95ED"),513),[[E,!s(e).isEdit]]),Ie]),y(t("div",Oe,[(g(!0),m(w,null,V(s(e).transferPublicConfig,(o,h)=>(g(),m("div",{class:"editBottom-first",key:h},[t("div",null,"\u7B2C"+T(h)+"\u5C42",1),we,t("div",Se,[h?(g(),P(A,{key:1,value:o.orgType,"onUpdate:value":c=>o.orgType=c,disabled:!s(e).isEdit,placeholder:"\u8BF7\u9009\u62E9\u7EC4\u7EC7\u7C7B\u578B",options:_.value,allowClear:""},null,8,["value","onUpdate:value","disabled","options"])):(g(),P(p,{key:0,disabled:"",value:s(e).first,"onUpdate:value":u[3]||(u[3]=c=>s(e).first=c)},null,8,["value"]))]),Le,t("div",Ne,[C(r,{value:o.validTime,"onUpdate:value":c=>o.validTime=c,disabled:!s(e).isEdit,placeholder:"\u8BF7\u8F93\u5165\u6B63\u6574\u6570",min:1},null,8,["value","onUpdate:value","disabled"]),ze]),h>0&&s(e).isEdit?(g(),m("div",{key:0,class:"delete",onClick:c=>$(h)},[C(s(le),{style:{fontSize:"20px"}})],8,Ve)):j("",!0)]))),128)),y(t("div",{class:"addconfig",onClick:X},Je,512),[[E,s(e).isEdit]]),t("div",Ge,[He,Qe,t("div",Xe,[C(A,{value:s(e).orgType,"onUpdate:value":u[4]||(u[4]=o=>s(e).orgType=o),placeholder:"\u8BF7\u9009\u62E9\u7EC4\u7EC7\u7C7B\u578B",options:_.value,allowClear:"",disabled:!s(e).isEdit},null,8,["value","options","disabled"])])])],512),[[E,s(e).checked]])])])],64)}}});var We=Y($e,[["__scopeId","data-v-79c8bd75"]]);export{We as default};
