var H=Object.defineProperty,J=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var S=(t,u,l)=>u in t?H(t,u,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[u]=l,V=(t,u)=>{for(var l in u||(u={}))z.call(u,l)&&S(t,l,u[l]);if(M)for(var l of M(u))Q.call(u,l)&&S(t,l,u[l]);return t},U=(t,u)=>J(t,G(u));var $=(t,u,l)=>new Promise((i,p)=>{var r=s=>{try{g(l.next(s))}catch(h){p(h)}},_=s=>{try{g(l.throw(s))}catch(h){p(h)}},g=s=>s.done?i(s.value):Promise.resolve(s.value).then(r,_);g((l=l.apply(t,u)).next())});import{B as W}from"./BasicForm.3d2570da.js";import{x as X,y as Y}from"./componentMap.b6eed178.js";import{u as Z}from"./useForm.871d18c5.js";import"./RadioButtonGroup.c6ce22c0.js";import{a as q,a6 as y,z as m,X as ee,a0 as w,U as k,o as b,k as C,G as A,l as T,i as E,N as R,j as x,a1 as te,n as B,a9 as ae,t as ie,p as D,r as le,Q as L,bO as se,fw as ne,T as ue,dw as re,B as oe,ea as K,J as I,an as ce}from"./index.397c0bf9.js";import"./JDictSelectTag.67e5d4c9.js";import"./JUpload.9a731a32.js";import{f as de}from"./DemoTest.data.b2f01f9c.js";import{_ as fe}from"./NextEditorTable.14a098e0.js";import{N as me}from"./index.3610e064.js";import"./FormItem.vue_vue_type_script_lang.17542945.js";import"./index.7ab28a2b.js";import"./BasicModal.1ff6964e.js";import"./useWindowSizeFn.830b179a.js";import"./index.1ddf0867.js";import"./useFormItem.3d0c36d5.js";import"./download.2b828441.js";import"./base64Conver.bb012c73.js";import"./index.4874795c.js";import"./index.de31474f.js";import"./useCountdown.31522075.js";import"./api.2a8d49a5.js";import"./props.12587afd.js";import"./Tree.vue_vue_type_style_index_0_lang.3391c5ca.js";import"./useContextMenu.7724d5f8.js";import"./index.a1e3eaae.js";import"./onMountedOrActivated.752d8da8.js";import"./index.efede30e.js";import"./htmlmixed.d0c2a650.js";import"./vue.651b9432.js";import"./depart.api.d716bbdd.js";import"./index.4e16446b.js";import"./EditOutlined.91a9672d.js";import"./functional.540b215d.js";import"./render.bf5724a4.js";import"./index.e3d374a0.js";const pe=q({__name:"NextTree",props:{selectedKeys:y.array.def(()=>[]),checkedKeys:y.array.def(()=>[]),parentCodeRootValue:y.string.def(""),parentCodeKey:y.string.def("parentCode"),searchKey:y.string.def("name"),valueKey:y.string.def("value"),labelKey:y.string.def("label"),childrenKey:y.string.def("children"),isLeafKey:y.string.def("isLeaf"),async:y.bool.def(!1),multiple:y.bool.def(!1),checkable:y.bool.def(!1),defaultExpandAll:y.bool.def(!1),placeholder:y.string.def("\u5173\u952E\u5B57\u641C\u7D22..."),rootApi:y.string.def(""),searchApi:y.string.def("")},emits:["check","select","update:checkedKeys","update:selectedKeys"],setup(t,{expose:u,emit:l}){const i=t,p=m(!1),r=m([]),_=m(!1),g=m(!0),s=m("");ee(()=>i.parentCodeRootValue,()=>h(),{deep:!0,immediate:!0});function h(){return $(this,null,function*(){let e={[i.parentCodeKey]:i.parentCodeRootValue},a=yield w.get({url:i.rootApi,params:e});r.value=[...a],v(a)})}function v(e){let a=i.valueKey;for(let o of e)o.key=o[a],o.title=o[i.labelKey],o.isLeaf=o[i.isLeafKey],o[i.childrenKey]&&o[i.childrenKey].length>0&&v(o[i.childrenKey])}function F(e){return $(this,null,function*(){if(!i.async||e.dataRef.children&&e.dataRef.children.length)return Promise.resolve();let a=e.dataRef.key,o={[i.parentCodeKey]:a},f=yield w.get({url:i.rootApi,params:o});return v(f),N(a,f,r.value),r.value=[...r.value],Promise.resolve()})}function N(e,a,o){if(o&&o.length>0)for(let f of o)if(f.key==e){!a||a.length==0?f.leaf=!0:f.children=a;break}else N(e,a,f.children)}function c(e){let a=[];Array.isArray(e)?a=e:a=e.checked,l("check",e),l("update:checkedKeys",x(a))}function d(e,a){l("select",a.selectedNodes[0]?a.selectedNodes[0].props:null),l("update:selectedKeys",e)}function n(e){return $(this,null,function*(){if(e)try{p.value=!0,r.value=[];let a={[i.searchKey]:e},o=yield yield w.get({url:i.searchApi,params:a});Array.isArray(o)&&(r.value=o)}finally{p.value=!1}else h();s.value=e})}return u({loadRoot:h}),(e,a)=>{const o=k("a-input-search"),f=k("a-tree"),j=k("a-empty"),O=k("a-spin");return b(),C(O,{spinning:p.value},{default:A(()=>[i.searchApi?(b(),C(o,{key:0,placeholder:i.placeholder,allowClear:"",style:{"margin-bottom":"20px"},onSearch:n},null,8,["placeholder"])):T("",!0),r.value.length>0?(b(),E(R,{key:1},[_.value?T("",!0):(b(),C(f,{key:0,treeData:r.value,selectedKeys:i.selectedKeys,checkedKeys:i.checkedKeys,checkStrictly:g.value,"load-data":F,checkable:i.checkable,multiple:i.multiple,defaultExpandAll:i.defaultExpandAll,onCheck:c,onSelect:d},null,8,["treeData","selectedKeys","checkedKeys","checkStrictly","checkable","multiple","defaultExpandAll"]))],64)):(b(),C(j,{key:2,description:"\u6682\u65E0\u6570\u636E"}))]),_:1},8,["spinning"])}}});function ye({tableName:t,mainKey:u,mainValue:l,apiPrefix:i}){const p=i?`/${i}/picture/${t}/query/${u}/${l}`:`/picture/${t}/query/${u}/${l}`;return w.post({url:p})}function he({tableName:t,mainKey:u,mainValue:l,apiPrefix:i},p){const r=i?`/${i}/picture/${t}/saveBatch/${u}/${l}`:`/picture/${t}/saveBatch/${u}/${l}`;return w.post({url:r,params:p})}const P={detail:{require:!1,isUpload:!1,isDel:!1,isEditFileName:!1,isEditFileDescribe:!1,fileDescribeMaxLength:200,fileNameMaxLength:200,isPreview:!0,isDownLoad:!0},editor:{require:!1,isUpload:!0,isDel:!0,isEditFileName:!0,isEditFileDescribe:!0,fileDescribeMaxLength:200,fileNameMaxLength:200,isPreview:!0,isDownLoad:!0}};const{createMessage:ge}=ue(),ve={name:"NextAttachment",components:{NextUpload:me},props:{tableName:{type:String,default:""},mainKey:{type:String,default:""},mainValue:{type:String,default:""},action:{type:String,default:""},dictCode:{type:String,default:""},showFileName:{type:Boolean,default:!1},showFileDescribe:{type:Boolean,default:!1},typeKey:{type:String,default:"type"},fileNameKey:{type:String,default:"fileName"},fileIdKey:{type:String,default:"fileId"},fileDescribeKey:{type:String,default:"fileDescribe"},apiPrefix:{type:String,default:""},dictConf:{type:Object,default:()=>({})}},setup(t,{emit:u,expose:l}){let i=[],p=[];const r=m([]);function _(){Promise.all([s(t.dictCode),h({tableName:t.tableName,mainKey:t.mainKey,mainValue:t.mainValue,apiPrefix:t.apiPrefix})]).then(()=>{let c=p.map(n=>(n.fileList=i.filter(e=>e[t.typeKey]===n.value).map(e=>({fileId:e[t.fileIdKey],fileName:e[t.fileNameKey],fileDescribe:e[t.fileDescribeKey]})),n)),d=[];d=c.filter(n=>{const e=Object.keys(t.dictConf||{}).indexOf(n.value)!==-1;if(e){const a=L(t.dictConf)[n.value]||{};n.setting=a[t.action]?se({},P.editor,a[t.action]):P.editor}return e}),r.value=d})}function g(c,d){r.value[c]&&(r.value[c].fileList=d||[])}function s(c){return ne(c).then(d=>{p=d||[]})}function h(c,d,n){return t.action==="add"?Promise.resolve(()=>{i=[]}):ye(c).then(e=>{i=e||[]})}function v(){let c="";return{isVerify:L(r.value).every(n=>{const e=n.setting;return e.require&&n.fileList.length==0?(c=`\u8BF7\u5148\u4E0A\u4F20${n.title}`,!1):e.hasOwnProperty("minNum")&&n.fileList.length<e.minNum?(c=`${n.title}\u81F3\u5C11\u9700\u8981\u4E0A\u4F20${e.minNum}\u4E2A\u6587\u4EF6`,!1):e.hasOwnProperty("maxNum")&&n.fileList.length>e.maxNum?(c=`${n.title}\u6700\u591A\u80FD\u4E0A\u4F20${e.maxNum}\u4E2A\u6587\u4EF6`,!1):!0}),msg:c,data:F()}}function F(){let c=[];const d=L(r.value);for(let n=0;n<d.length;n++){const e=d[n].fileList||[];for(let a=0;a<e.length;a++)c.push({[t.typeKey]:d[n].value,[t.mainKey]:t.mainValue,[t.fileNameKey]:e[a].fileName,[t.fileIdKey]:e[a].fileId,[t.fileDescribeKey]:e[a].fileDescribe})}return c}function N(c){const d=v(),n=c?!0:d.isVerify,e=c||d.data;return n?he({tableName:t.tableName,mainKey:t.mainKey,mainValue:t.mainValue,apiPrefix:t.apiPrefix},e):(ge.warning(d.msg),Promise.reject())}return _(),l({verify:v,dataList:r,save:N}),{dataList:r,handleChange:g}}},_e={class:"attachment-card"},be={class:"describe"},De={key:0,class:"require-mark"};function Ke(t,u,l,i,p,r){const _=k("next-upload"),g=k("a-card");return b(),C(g,null,{default:A(()=>[B("div",_e,[(b(!0),E(R,null,ae(i.dataList,(s,h)=>(b(),E("div",{key:h,class:"attachment-item"},[B("div",be,[s.setting&&s.setting.require==!0?(b(),E("span",De,"*")):T("",!0),B("span",null,ie(s.title),1)]),D(_,{class:le({"next-upload-disabled":!s.setting.isUpload}),disabled:!s.setting.isUpload,value:s.fileList,"onUpdate:value":v=>s.fileList=v,showFileName:l.showFileName,showFileDescribe:l.showFileDescribe,accept:s.setting.accept,isDel:s.setting.isDel,isPreview:s.setting.isPreview,isDownLoad:s.setting.isDownLoad,isEditFileName:s.setting.isEditFileName,isEditFileDescribe:s.setting.isEditFileDescribe,fileNameMaxLength:s.setting.fileNameMaxLength,fileDescribeMaxLength:s.setting.fileDescribeMaxLength,onChange:v=>i.handleChange(h,v)},null,8,["class","disabled","value","onUpdate:value","showFileName","showFileDescribe","accept","isDel","isPreview","isDownLoad","isEditFileName","isEditFileDescribe","fileNameMaxLength","fileDescribeMaxLength","onChange"])]))),128))])]),_:1})}var xe=te(ve,[["render",Ke],["__scopeId","data-v-a3b5a2bc"]]);const ke=B("h3",{style:{background:"#fff",padding:"20px"}},"\u9644\u4EF6\u6D4B\u8BD5",-1),Fe=I("\u6253\u5370\u6D4B\u8BD5\u6570\u636E"),Ne=B("h3",{style:{background:"#fff",padding:"20px"}},"form\u8868\u53551",-1),Be=B("h3",{style:{background:"#fff",padding:"20px"}},"form\u8868\u53552",-1),Ce=I("\u6D4B\u8BD5"),we=q({name:"aUser21-aUser21"}),mt=q(U(V({},we),{setup(t){const{setTitle:u}=re();u("\u52A8\u6001\u4FEE\u6539tab\u7684title");const l=m(["a7d7e77e06c84325a40932163adcdaa6"]),i=m([]),p=m([]);m([]);const r=m(""),_=m(null);oe({lng:113.37336921217202,lat:23.10634468569264});const g=m(""),s=m("");m("");const h=m([{title:"\u5B57\u6BB5\u540D\u79F0",key:"dbFieldName",type:K.input,placeholder:"\u8BF7\u8F93\u5165${title}",disabled:!0},{title:"\u9875\u9762\u540D\u79F0",key:"dbFieldTxt",type:K.input,placeholder:"\u8BF7\u8F93\u5165${title}",disabled:!0},{title:"\u6269\u5C55\u53C2\u6570",key:"searchExtendJson",type:K.textarea,titleHelp:{icon:"vxe-icon--question",message:"\u7ED1\u5B9A\u7EC4\u4EF6\u6269\u5C55\u53C2\u6570\uFF0C\u89C1vue3JBoot\u524D\u7AEF\u6587\u6863\uFF01"}},{title:"\u5B57\u5178Table",key:"queryDictTable",type:K.input,titleHelp:{icon:"vxe-icon--question",message:"\u5173\u8054\u7684\u8868\u540D"}},{title:"\u5B57\u5178Code",key:"queryDictField",type:K.input,titleHelp:{icon:"vxe-icon--question",message:"\u5173\u8054\u7684\u8868\u5B57\u6BB5"}},{title:"\u5B57\u5178Text",key:"queryDictText",type:K.input,titleHelp:{icon:"vxe-icon--question",message:"\u5173\u8054\u7684\u8868\u7FFB\u8BD1\u5B57\u6BB5"}},{title:"\u662F\u5426\u67E5\u8BE2",key:"isQuery",type:K.checkbox,customValue:[1,0],defaultChecked:!1},{title:"\u67E5\u8BE2\u7C7B\u578B",key:"queryMode",type:K.select,placeholder:"\u8BF7\u9009\u62E9${title}",validateRules:[{required:!0,message:"\u8BF7\u9009\u62E9${title}"}],options:[{title:"\u666E\u901A\u67E5\u8BE2",value:"single"},{title:"\u8303\u56F4\u67E5\u8BE2",value:"group"},{title:"\u5173\u8054\u67E5\u8BE2",value:"com"}],defaultValue:"single"}]),v=m("0,6"),F=m(""),[N,c]=Z({labelWidth:150,schemas:de,showActionButtonGroup:!1});function d(){console.log("99999",L(l.value)),console.log("88888",L(i.value)),console.log("77777",x(v)),console.log("66666",x(F))}function n(){console.log("77777",x(r)),console.log("66666",x(F)),ce(()=>{const e=_.value.save().then(a=>{});console.log(222222,e)})}return(e,a)=>{const o=k("a-button");return b(),E("div",null,[D(X,{lat:g.value,"onUpdate:lat":a[0]||(a[0]=f=>g.value=f),lng:s.value,"onUpdate:lng":a[1]||(a[1]=f=>s.value=f),ifShowTabsIndexes:!0},null,8,["lat","lng"]),ke,D(o,{onClick:n},{default:A(()=>[Fe]),_:1}),D(xe,{ref_key:"nextAttachment",ref:_,action:"editor",tableName:"hdCommunityFileDraft",mainKey:"communityId",dictCode:"communityAttType",fileNameKey:"fileName",fileIdKey:"fileUrl",mainValue:45454545,fileDescribeKey:"fileDesc",showFileName:!0,showFileDescribe:!0,typeKey:"communityAttType",dictConf:{cover:{see:{require:!1,isUpload:!1},editor:{require:!0,isEditFileName:!0,isEditFileDescribe:!1,fileDescribeMaxLength:200,fileNameMaxLength:10,minNum:3,isPreview:!0,isDel:!0},add:{require:!0,isUpload:!0,minNum:2,maxNum:5}},bird:{editor:{require:!0,isEditFileName:!1,minNum:0,isPreview:!0,isDel:!0}}}},null,512),Ne,D(x(W),{onRegister:x(N)},null,8,["onRegister"]),Be,D(Y,{rootApi:"/sys/sysDepart/queryDepartTreeSync",parentCodeKey:"pid",async:!0,valueKey:"id",labelKey:"departName",multiple:!0,placeholder:"\u8BF7\u9009\u62E9"}),D(pe,{rootApi:"/sys/sysDepart/queryDepartTreeSync",parentCodeKey:"pid",async:!0,valueKey:"id",labelKey:"departName",checkable:"",selectedKeys:l.value,"onUpdate:selectedKeys":a[2]||(a[2]=f=>l.value=f),checkedKeys:i.value,"onUpdate:checkedKeys":a[3]||(a[3]=f=>i.value=f)},null,8,["selectedKeys","checkedKeys"]),D(o,{onClick:d},{default:A(()=>[Ce]),_:1}),D(fe,{value:p.value,"onUpdate:value":a[4]||(a[4]=f=>p.value=f),columns:h.value},null,8,["value","columns"])])}}}));export{mt as default};
