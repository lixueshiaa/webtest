var h=(o,r,p)=>new Promise((C,m)=>{var B=t=>{try{l(p.next(t))}catch(_){m(_)}},s=t=>{try{l(p.throw(t))}catch(_){m(_)}},l=t=>t.done?C(t.value):Promise.resolve(t.value).then(B,s);l((p=p.apply(o,r)).next())});import{B as Y}from"./index.991a4e0a.js";import{s as $}from"./jvxetable.api.b9c461c6.js";import{o as I,a as N}from"./api.d23be3dc.js";import{a as q,z as L,B as U,bg as z,j as E,f as S,a1 as V,U as i,o as F,k as A,G as u,p as e,n as H,i as O,a9 as j,N as T,ad as J,J as d}from"./index.d537950e.js";import"./BasicModal.5a168f1c.js";import"./useWindowSizeFn.5f6046fd.js";const P=q({name:"tableModal",components:{BasicModal:Y},emits:["success","register"],setup(o,{emit:r}){const p=L(!0),C=L(""),m=L(),B=U({xs:{span:24},sm:{span:5}}),s=U({xs:{span:24},sm:{span:16}}),l={orderCode:[{required:!0,message:"\u8BA2\u5355\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]},t=U({id:null,orderCode:"",orderMoney:"",ctype:"",content:"",jeecgOrderCustomerList:[],jeecgOrderTicketList:[]}),[_,{setModalProps:v,closeModal:M}]=z(a=>h(this,null,function*(){if(v({confirmLoading:!1}),p.value=!!(a!=null&&a.isUpdate),y(),E(p)){C.value=a.record.id,Object.assign(t,a.record);let c={id:t.id};const n=yield I(c);t.jeecgOrderCustomerList=n;const R=yield N(c);t.jeecgOrderTicketList=R}})),f=S(()=>E(p)?"\u7F16\u8F91":"\u65B0\u589E");function g(){t.jeecgOrderCustomerList.push({})}function k(a){t.jeecgOrderCustomerList.splice(a,1),t.jeecgOrderCustomerList.splice(a,1)}function y(){t.id=null,t.orderCode="",t.orderMoney="",t.orderDate=null,t.ctype="",t.content="",t.jeecgOrderCustomerList=[],t.jeecgOrderTicketList=[]}function b(){t.jeecgOrderTicketList.push({})}function D(a){t.jeecgOrderTicketList.splice(a,1),t.jeecgOrderTicketList.splice(a,1)}function w(){return h(this,null,function*(){m.value.validate().then(()=>h(this,null,function*(){try{console.log("formData",JSON.stringify(t)),v({confirmLoading:!0}),yield $(t,E(p)),M(),r("success")}finally{v({confirmLoading:!1})}})).catch(a=>{console.log("error",a)})})}return{formRef:m,validatorRules:l,orderMainModel:t,registerModal:_,getTitle:f,labelCol:B,wrapperCol:s,addRowCustom:g,delRowCustom:k,addRowTicket:b,delRowTicket:D,handleSubmit:w}}}),G=d("\u56FD\u5185\u8BA2\u5355"),K=d("\u56FD\u9645\u8BA2\u5355"),Q=d("\u5BA2\u6237\u540D"),W=d("\u6027\u522B"),X=d("\u8EAB\u4EFD\u8BC1\u53F7\u7801"),Z=d("\u624B\u673A\u53F7"),x=d("\u64CD\u4F5C"),ee=d("\u7537"),ue=d("\u5973"),te=d(" \u6DFB\u52A0\u5BA2\u6237\u4FE1\u606F "),ae=d("\u822A\u73ED\u53F7"),oe=d("\u822A\u73ED\u65F6\u95F4"),le=d("\u64CD\u4F5C"),ne=d(" \u6DFB\u52A0\u673A\u7968\u4FE1\u606F ");function re(o,r,p,C,m,B){const s=i("a-input"),l=i("a-form-item"),t=i("a-col"),_=i("a-select-option"),v=i("a-select"),M=i("a-date-picker"),f=i("a-row"),g=i("Icon"),k=i("a-button"),y=i("a-tab-pane"),b=i("a-tabs"),D=i("a-form"),w=i("BasicModal");return F(),A(w,J(o.$attrs,{onRegister:o.registerModal,title:o.getTitle,onOk:o.handleSubmit,width:"70%"}),{default:u(()=>[e(D,{ref:"formRef",model:o.orderMainModel,"label-col":o.labelCol,"wrapper-col":o.wrapperCol,rules:o.validatorRules},{default:u(()=>[e(f,{class:"form-row",gutter:16},{default:u(()=>[e(t,{lg:8},{default:u(()=>[e(l,{label:"\u8BA2\u5355\u53F7",name:"orderCode"},{default:u(()=>[e(s,{value:o.orderMainModel.orderCode,"onUpdate:value":r[0]||(r[0]=a=>o.orderMainModel.orderCode=a),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u53F7"},null,8,["value"])]),_:1})]),_:1}),e(t,{lg:8},{default:u(()=>[e(l,{label:"\u8BA2\u5355\u7C7B\u578B"},{default:u(()=>[e(v,{placeholder:"\u8BF7\u9009\u62E9\u8BA2\u5355\u7C7B\u578B",value:o.orderMainModel.ctype,"onUpdate:value":r[1]||(r[1]=a=>o.orderMainModel.ctype=a)},{default:u(()=>[e(_,{value:"1"},{default:u(()=>[G]),_:1}),e(_,{value:"2"},{default:u(()=>[K]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t,{lg:8},{default:u(()=>[e(l,{label:"\u8BA2\u5355\u65E5\u671F"},{default:u(()=>[e(M,{showTime:"",valueFormat:"YYYY-MM-DD HH:mm:ss",value:o.orderMainModel.orderDate,"onUpdate:value":r[2]||(r[2]=a=>o.orderMainModel.orderDate=a)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(f,{class:"form-row",gutter:16},{default:u(()=>[e(t,{lg:8},{default:u(()=>[e(l,{label:"\u8BA2\u5355\u91D1\u989D"},{default:u(()=>[e(s,{value:o.orderMainModel.orderMoney,"onUpdate:value":r[3]||(r[3]=a=>o.orderMainModel.orderMoney=a),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u91D1\u989D"},null,8,["value"])]),_:1})]),_:1}),e(t,{lg:8},{default:u(()=>[e(l,{label:"\u8BA2\u5355\u5907\u6CE8"},{default:u(()=>[e(s,{value:o.orderMainModel.content,"onUpdate:value":r[4]||(r[4]=a=>o.orderMainModel.content=a),placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u5907\u6CE8"},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(b,{defaultActiveKey:"1"},{default:u(()=>[e(y,{tab:"\u5BA2\u6237\u4FE1\u606F",key:"1"},{default:u(()=>[H("div",null,[e(f,{type:"flex",style:{"margin-bottom":"10px"},gutter:16},{default:u(()=>[e(t,{span:5},{default:u(()=>[Q]),_:1}),e(t,{span:5},{default:u(()=>[W]),_:1}),e(t,{span:6},{default:u(()=>[X]),_:1}),e(t,{span:6},{default:u(()=>[Z]),_:1}),e(t,{span:2},{default:u(()=>[x]),_:1})]),_:1}),(F(!0),O(T,null,j(o.orderMainModel.jeecgOrderCustomerList,(a,c)=>(F(),A(f,{type:"flex",style:{"margin-bottom":"10px"},gutter:16,key:c},{default:u(()=>[e(t,{span:6,style:{display:"none"}},{default:u(()=>[e(l,null,{default:u(()=>[e(s,{placeholder:"id",value:a.id,"onUpdate:value":n=>a.id=n},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(t,{span:5},{default:u(()=>[e(l,null,{default:u(()=>[e(s,{placeholder:"\u5BA2\u6237\u540D",value:a.name,"onUpdate:value":n=>a.name=n},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(t,{span:5},{default:u(()=>[e(l,null,{default:u(()=>[e(v,{placeholder:"\u6027\u522B",value:a.sex,"onUpdate:value":n=>a.sex=n},{default:u(()=>[e(_,{value:"1"},{default:u(()=>[ee]),_:1}),e(_,{value:"2"},{default:u(()=>[ue]),_:1})]),_:2},1032,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(t,{span:6},{default:u(()=>[(F(),A(l,{name:["jeecgOrderCustomerList",c,"idcard"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1\u53F7",trigger:"blur"}],key:c},{default:u(()=>[e(s,{placeholder:"\u8EAB\u4EFD\u8BC1\u53F7",value:a.idcard,"onUpdate:value":n=>a.idcard=n},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]))]),_:2},1024),e(t,{span:6},{default:u(()=>[e(l,{name:["jeecgOrderCustomerList",c,"telphone"]},{default:u(()=>[e(s,{placeholder:"\u624B\u673A\u53F7",value:a.telphone,"onUpdate:value":n=>a.telphone=n},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(t,{span:2},{default:u(()=>[e(l,null,{default:u(()=>[e(g,{icon:"ant-design:minus-outlined",onClick:n=>o.delRowCustom(c),style:{fontsize:"20px"}},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(k,{type:"dashed",style:{width:"98%","margin-top":"10px"},onClick:o.addRowCustom},{default:u(()=>[e(g,{icon:"ph:plus-bold"}),te]),_:1},8,["onClick"])])]),_:1}),e(y,{tab:"\u673A\u7968\u4FE1\u606F",key:"2",forceRender:""},{default:u(()=>[e(f,{type:"flex",style:{"margin-bottom":"10px"},gutter:16},{default:u(()=>[e(t,{span:6},{default:u(()=>[ae]),_:1}),e(t,{span:6},{default:u(()=>[oe]),_:1}),e(t,{span:6},{default:u(()=>[le]),_:1})]),_:1}),(F(!0),O(T,null,j(o.orderMainModel.jeecgOrderTicketList,(a,c)=>(F(),A(f,{type:"flex",style:{"margin-bottom":"10px"},gutter:16,key:c},{default:u(()=>[e(t,{span:6,style:{display:"none"}},{default:u(()=>[e(l,null,{default:u(()=>[e(s,{placeholder:"id",value:a.id,"onUpdate:value":n=>a.id=n},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(t,{span:6},{default:u(()=>[e(l,{name:["jeecgOrderTicketList",c,"ticketCode"],rules:{required:!0,message:"\u8BF7\u8F93\u5165\u822A\u73ED\u53F7",trigger:"blur"}},{default:u(()=>[e(s,{placeholder:"\u822A\u73ED\u53F7",value:a.ticketCode,"onUpdate:value":n=>a.ticketCode=n},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(t,{span:6},{default:u(()=>[e(l,null,{default:u(()=>[e(M,{placeholder:"\u822A\u73ED\u65F6\u95F4",valueFormat:"YYYY-MM-DD",value:a.tickectDate,"onUpdate:value":n=>a.tickectDate=n},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(t,{span:6},{default:u(()=>[e(l,null,{default:u(()=>[e(g,{icon:"ant-design:minus-outlined",onClick:n=>o.delRowTicket(c),style:{fontsize:"20px"}},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(k,{type:"dashed",style:{width:"98%","margin-top":"10px"},onClick:o.addRowTicket},{default:u(()=>[e(g,{icon:"ph:plus-bold"}),ne]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model","label-col","wrapper-col","rules"])]),_:1},16,["onRegister","title","onOk"])}var me=V(P,[["render",re],["__scopeId","data-v-3cb7d8c8"]]);export{me as default};
