var G=Object.defineProperty;var y=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var p=(e,r,s)=>r in e?G(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,b=(e,r)=>{for(var s in r||(r={}))_.call(r,s)&&p(e,s,r[s]);if(y)for(var s of y(r))j.call(r,s)&&p(e,s,r[s]);return e};var h=(e,r,s)=>new Promise((o,t)=>{var l=c=>{try{d(s.next(c))}catch(a){t(a)}},i=c=>{try{d(s.throw(c))}catch(a){t(a)}},d=c=>c.done?o(c.value):Promise.resolve(c.value).then(l,i);d((s=s.apply(e,r)).next())});import{z as k,f as n,c as f,j as u,$ as O}from"./index.d537950e.js";var E=(e=>(e[e.LOGIN=0]="LOGIN",e[e.REGISTER=1]="REGISTER",e[e.RESET_PASSWORD=2]="RESET_PASSWORD",e[e.MOBILE=3]="MOBILE",e[e.QR_CODE=4]="QR_CODE",e))(E||{}),S=(e=>(e.LOGIN="0",e.REGISTER="1",e.FORGET_PASSWORD="2",e))(S||{});const F=k(0);function Q(){function e(o){F.value=o}const r=n(()=>F.value);function s(){e(0)}return{setLoginState:e,getLoginState:r,handleBackLogin:s}}function U(e){function r(){return h(this,null,function*(){const s=u(e);return s?yield s.validate():void 0})}return{validForm:r}}function $(e){const{t:r}=f(),s=n(()=>m(r("sys.login.accountPlaceholder"))),o=n(()=>m(r("sys.login.passwordPlaceholder"))),t=n(()=>m(r("sys.login.smsPlaceholder"))),l=n(()=>m(r("sys.login.mobilePlaceholder"))),i=n(()=>v("account")),d=n(()=>v("mobile")),c=(R,g)=>h(this,null,function*(){return g?Promise.resolve():Promise.reject(r("sys.login.policyPlaceholder"))}),a=R=>(g,P)=>h(this,null,function*(){return P?P!==R?Promise.reject(r("sys.login.diffPwd")):Promise.resolve():Promise.reject(r("sys.login.passwordPlaceholder"))});return{getFormRules:n(()=>{const R=u(s),g=u(o),P=u(t),A=u(l),B=u(i),I=u(d),w={sms:P,mobile:A};switch(u(F)){case 1:return{account:B,password:g,mobile:I,sms:P,confirmPassword:[{validator:a(e==null?void 0:e.password),trigger:"change"}],policy:[{validator:c,trigger:"change"}]};case 2:return b({username:R,confirmPassword:[{validator:a(e==null?void 0:e.password),trigger:"change"}]},w);case 3:return w;default:return{account:R,password:g}}})}}function m(e){return[{required:!0,message:e,trigger:"change"}]}function v(e){return[{validator:e=="account"?T:M,trigger:"change"}]}function T(e,r,s){const{t:o}=f();return r?new Promise((t,l)=>{O({username:r}).then(i=>{i.success?t():l("\u7528\u6237\u540D\u5DF2\u5B58\u5728!")})}):Promise.reject(o("sys.login.accountPlaceholder"))}function M(e,r,s){return h(this,null,function*(){f();var o=/^1[3456789]\d{9}$/;return o.test(r)?new Promise((t,l)=>{O({phone:r}).then(i=>{i.success?t():l("\u624B\u673A\u53F7\u5DF2\u5B58\u5728!")})}):Promise.reject(new Error("\u8BF7\u8F93\u5165\u6B63\u786E\u624B\u673A\u53F7"))})}export{E as L,S,$ as a,U as b,Q as u};
