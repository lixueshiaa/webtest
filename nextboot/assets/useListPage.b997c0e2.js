var j=Object.defineProperty,A=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var R=(e,l,c)=>l in e?j(e,l,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[l]=c,h=(e,l)=>{for(var c in l||(l={}))p.call(l,c)&&R(e,c,l[c]);if(O)for(var c of O(l))E.call(l,c)&&R(e,c,l[c]);return e},F=(e,l)=>A(e,W(l));var y=(e,l,c)=>new Promise((t,f)=>{var w=r=>{try{o(c.next(r))}catch(d){f(d)}},b=r=>{try{o(c.throw(r))}catch(d){f(d)}},o=r=>r.done?t(r.value):Promise.resolve(r.value).then(w,b);o((c=c.apply(e,l)).next())});import"./BasicTable.1032ab26.js";import{o as I}from"./componentMap.6942b0b6.js";import"./TableImg.39540c6d.js";import{u as L}from"./useTable.44d02b40.js";import{b as M,bO as X,z as T,B as k,T as B,ec as D}from"./index.9eb451d3.js";const{handleExportXls:K,handleImportXls:P}=I();function N(e){const l=B();let c={};e.designScope&&(c=M(e.designScope));const t=z(e.tableProps),[,{getForm:f,reload:w,setLoading:b},{selectedRowKeys:o}]=t;function r(){return y(this,null,function*(){var s;let{url:a,name:n,params:i}=(s=e==null?void 0:e.exportConfig)!=null?s:{};if(a){let m=typeof n=="function"?n():n,u=yield f().validate();const x=f().getFieldsValue();return u=Object.assign({},u,x),i&&(u=Object.assign({},u,i)),o.value&&o.value.length>0&&(u.selections=o.value.join(",")),K(m,a,D(u))}else return l.createMessage.warn("\u6CA1\u6709\u4F20\u9012 exportConfig.url \u53C2\u6570"),Promise.reject()})}function d(a){var s;let{url:n,success:i}=(s=e==null?void 0:e.importConfig)!=null?s:{};return n?P(a,n,i||w):(l.createMessage.warn("\u6CA1\u6709\u4F20\u9012 importConfig.url \u53C2\u6570"),Promise.reject())}function C(a,n){return new Promise((i,s)=>{var u;const m=()=>y(this,null,function*(){var x,v;try{b(!0);const S=yield a();((x=n==null?void 0:n.reload)==null||x)&&w(),((v=n==null?void 0:n.clearSelection)==null||v)&&(o.value=[]),i(S)}catch(S){s(S)}finally{b(!1)}});(u=n==null?void 0:n.confirm)==null||u?l.createConfirm({iconType:"warning",title:"\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",onOk:()=>m(),onCancel:()=>s()}):m()})}function g(a){return C(a,{confirm:!1,clearSelection:!1})}return F(h(h({},c),l),{onExportXls:r,onImportXls:d,doRequest:C,doDeleteRecord:g,tableContext:t})}function z(e){var i,s,m;const l={xs:24,sm:12,md:12,lg:8,xl:8,xxl:6},c={xs:24,sm:8,md:6,lg:8,xl:6,xxl:6},t=e.formConfig||{},f=t.labelCol?t==null?void 0:t.labelCol:h({},c),w=t!=null&&t.baseColProps?t==null?void 0:t.baseColProps:h({},l),b=t!=null&&t.labelWidth?t==null?void 0:t.labelWidth:void 0,o=t!=null&&t.actionColOptions?t==null?void 0:t.actionColOptions:F(h({},l),{style:{textAlign:"left"}}),r={rowKey:"id",useSearchForm:!0,formConfig:{compact:!0,labelWidth:b,autoSubmitOnEnter:!0,rowProps:{gutter:8},baseColProps:w,labelCol:f,wrapperCol:{},showAdvancedButton:!0,autoAdvancedCol:3,actionColOptions:o},striped:!0,canResize:!0,minHeight:500,clickToRowSelect:!1,bordered:!0,showIndexColumn:!1,showTableSetting:!0,tableSetting:{fullScreen:!0},showActionColumn:!0,actionColumn:{width:120,title:"\u64CD\u4F5C",fixed:!1,dataIndex:"action",slots:{customRender:"action"}}};e&&X(r,e);function d(u){return Object.assign({column:"createTime",order:"desc"},u)}Object.assign(r,{beforeFetch:d}),typeof e.beforeFetch=="function"&&(r.beforeFetch=function(u){return u=d(u),e.beforeFetch(u),u});const C=T([]),g=T([]),a=(i=e==null?void 0:e.rowSelection)!=null?i:{},n=k(F(h({},a),{type:(s=a.type)!=null?s:"checkbox",columnWidth:(m=a.columnWidth)!=null?m:50,selectedRows:g,selectedRowKeys:C,onChange(...u){C.value=u[0],g.value=u[1],typeof a.onChange=="function"&&a.onChange(...u)}}));return delete r.rowSelection,[...L(r),{selectedRows:g,selectedRowKeys:C,rowSelection:n}]}export{N as u};
