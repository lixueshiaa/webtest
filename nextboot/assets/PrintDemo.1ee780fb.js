import{P as E}from"./index.7910eff5.js";import{an as C,a1 as T,b6 as A,B,z as b,U as m,o as x,k as P,G as c,p as i,n as r,i as k,l as S,J as D,bP as L,bQ as W}from"./index.0c676cb0.js";import{$ as I}from"./print.b8ee1de4.js";import"./onMountedOrActivated.29514295.js";import"./useWindowSizeFn.f69fad46.js";import"./useContentViewHeight.3c3f37af.js";class H{constructor(e){this.standards={strict:"strict",loose:"loose",html5:"html5"},this.counter=0,this.settings={standard:this.standards.html5,extraHead:"",extraCss:"",popTitle:"",endCallback:null,el:""},Object.assign(this.settings,e),this.init()}init(){this.counter++,this.settings.id=`printArea_${this.counter}`;let e=document.getElementById(this.settings.id);e&&e.parentNode.removeChild(e);let t=this.getPrintWindow();this.write(t.doc),this.settings.endCallback()}print(e){let t=e;console.log("---\u8C03\u7528\u6253\u5370 focus-----"),t.focus(),t.print(),console.log("---\u8C03\u7528\u6253\u5370 print-----")}write(e,t){e.open(),e.write(`${this.docType()}<html>${this.getHead()}${this.getBody()}</html>`),e.close()}docType(){if(this.settings.standard===this.standards.html5)return"<!DOCTYPE html>";var e=this.settings.standard===this.standards.loose?" Transitional":"",t=this.settings.standard===this.standards.loose?"loose":"strict";return`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01${e}//EN" "http://www.w3.org/TR/html4/${t}.dtd">`}getHead(){let e="",t="",n="";this.settings.extraHead&&this.settings.extraHead.replace(/([^,]+)/g,function(o){e+=o}),[].forEach.call(document.querySelectorAll("link"),function(o,p){o.href.indexOf(".css")>=0&&(t+='<link type="text/css" rel="stylesheet" href="'+o.href+'" >')});for(let o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].cssRules||document.styleSheets[o].rules){let p=document.styleSheets[o].cssRules||document.styleSheets[o].rules;for(let a=0;a<p.length;a++)try{n+=p[a].cssText}catch(g){}}return this.settings.extraCss&&this.settings.extraCss.replace(/([^,\s]+)/g,function(o){t+=`<link type="text/css" rel="stylesheet" href="${o}">`}),`<head><title>${this.settings.popTitle}</title>${e}${t}<style type="text/css">${n}</style></head>`}getBody(){let t=this.getFormData(document.querySelector(this.settings.el)).outerHTML;return console.log("htm",t),"<body>"+t+"</body>"}getFormData(e){let t=this,n=e.cloneNode(!0),o=n.querySelectorAll("*");[].forEach.call(o,function(s){let u=s.getAttribute("ignore-print");u=u==null?s.getAttribute("ignoreprint"):u,u!=null&&u.toString()==="true"&&(s.outerHTML="")});let p=n.querySelectorAll("input,select,textarea");[].forEach.call(p,function(s,u){let d=s.getAttribute("type"),_=p[u];d==null&&(d=s.tagName==="SELECT"?"select":s.tagName==="TEXTAREA"?"textarea":""),d==="radio"||d==="checkbox"?_.setAttribute("checked",s.checked):d==="select"?[].forEach.call(_.querySelectorAll("option"),function(y,w){y.selected&&y.setAttribute("selected",!0)}):d==="textarea"?_.innerHTML=s.value:(_.value=s.value,_.setAttribute("value",s.value))});var a=e.querySelectorAll("canvas"),g=n.querySelectorAll("canvas");return[].forEach.call(g,function(s,u){t.isECharts(s)&&(s.parentElement.style.width&&(s.parentElement.style.width="100%"),s.parentElement.parentElement.style.width&&(s.parentElement.parentElement.style.width="100%"));var d=a[u].toDataURL();s.outerHTML='<img src="'+d+'" style="width:100%;"/>'}),n}isECharts(e){let t="_echarts_instance_",n=e.parentElement;return n.getAttribute(t)!=null?!0:n.parentElement.getAttribute(t)!=null}getPrintWindow(){var e=this.Iframe();return{win:e.contentWindow||e,doc:e.doc}}Iframe(){let e=this.settings.id,t;var n=this;try{t=document.createElement("iframe"),document.body.appendChild(t),t.style.border="0px",t.style.position="absolute",t.style.width="0px",t.style.height="0px",t.style.right="0px",t.style.top="0px",t.setAttribute("id",e),t.setAttribute("src",new Date().getTime()),t.doc=null,t.onload=function(){var o=t.contentWindow||t;n.print(o)},t.doc=t.contentDocument?t.contentDocument:t.contentWindow?t.contentWindow.document:t.document}catch(o){throw new Error(o+". iframes may not be supported in this browser.")}if(t.doc==null)throw new Error("Cannot find document.");return t}}function F(l){if((l==null?void 0:l.type)==="html")N(l.printable);else return I(l)}function N(l){l?U(l):window.print()}let v=!0;function U(l){typeof l=="string"&&!l.startsWith("#")&&(l="#"+l),C(()=>{v&&(v=!1,new H({el:l,endCallback(){v=!0}}))})}const R={name:"PrintDemo",components:{PageWrapper:E,Icon:A},props:{reBizCode:{type:String,default:""}},setup(){const l=B({printer:"\u5F20\u4E09",printTime:"2021-12-31 23:59:59",printContent:"\u6253\u5370\u5185\u5BB9\uFF1A\u8FD9\u662F\u4E00\u4E2A\u6253\u5370\u6D4B\u8BD5\uFF01",printReason:"\u505A\u4E00\u4E2A\u6253\u5370\u6D4B\u8BD5",fileList:[{uid:"-1",name:"xxx.png",status:"done",url:"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png"},{uid:"-2",name:"pic1.png",status:"done",url:"https://www.gizbot.com/img/2016/11/whatsapp-error-lead-image-08-1478607387.jpg"}]}),e=b(""),t=b(!1);function n(){F({printable:"#printContent",type:"html"})}function o(a){e.value=a.url||a.thumbUrl,t.value=!0}function p({fileList:a}){l.fileList=a}return{model:l,previewImage:e,previewVisible:t,onPrint:n,handlePreview:o,handleChange:p}}},f=l=>(L("data-v-3ba719f7"),l=l(),W(),l),V={style:{"text-align":"right"}},j=D("\u6253\u5370"),q={ref:"print",id:"printContent"},M=f(()=>r("div",{style:{"text-align":"center"}},[r("p",{style:{"font-size":"24px","font-weight":"800"}},"\u6253\u5370\u6D4B\u8BD5\u8868\u5355")],-1)),z={class:"sign",style:{"text-align":"left",height:"inherit"}},J=f(()=>r("span",null,"\u6253\u5370\u4EBA\u5458:",-1)),O=f(()=>r("span",{style:{"margin-left":"12.5%"}},"\u6253\u5370\u65E5\u671F:",-1)),$=f(()=>r("span",null,"\u6253\u5370\u5185\u5BB9:",-1)),Y=f(()=>r("span",null,"\u6253\u5370\u76EE\u7684:",-1)),Z=f(()=>r("span",null,"\u6253\u5370\u56FE\u7247:",-1)),G=f(()=>r("br",null,null,-1)),Q={key:0},X=f(()=>r("div",{class:"ant-upload-text"},"Upload",-1)),K=["src"];function tt(l,e,t,n,o,p){const a=m("a-button"),g=m("a-input"),s=m("a-col"),u=m("Icon"),d=m("a-upload"),_=m("a-modal"),y=m("a-card"),w=m("PageWrapper");return x(),P(w,null,{default:c(()=>[i(y,{bordered:!1,class:"j-print-demo"},{default:c(()=>[r("div",V,[i(a,{type:"primary",ghost:"",onClick:n.onPrint},{default:c(()=>[j]),_:1},8,["onClick"])]),r("section",q,[M,i(s,{md:24,sm:24},{default:c(()=>[r("div",z,[i(s,{span:24},{default:c(()=>[J,i(g,{style:{width:"30%"},value:n.model.printer,"onUpdate:value":e[0]||(e[0]=h=>n.model.printer=h)},null,8,["value"]),O,i(g,{style:{width:"30%"},value:n.model.printTime,"onUpdate:value":e[1]||(e[1]=h=>n.model.printTime=h)},null,8,["value"])]),_:1}),i(s,{span:24}),i(s,{span:24,style:{"margin-top":"20px"}},{default:c(()=>[$,i(g,{style:{width:"80%"},value:n.model.printContent,"onUpdate:value":e[2]||(e[2]=h=>n.model.printContent=h)},null,8,["value"])]),_:1}),i(s,{span:24,style:{"margin-top":"20px"}},{default:c(()=>[Y,i(g,{style:{width:"80%"},value:n.model.printReason,"onUpdate:value":e[3]||(e[3]=h=>n.model.printReason=h)},null,8,["value"])]),_:1}),i(s,{style:{"margin-top":"20px"},span:24},{default:c(()=>[Z,G,i(d,{action:"/jsonplaceholder.typicode.com/posts/",listType:"picture-card",fileList:n.model.fileList,onPreview:n.handlePreview,onChange:n.handleChange},{default:c(()=>[n.model.fileList.length<3?(x(),k("div",Q,[i(u,{icon:"ant-design:plus-outlined"}),X])):S("",!0)]),_:1},8,["fileList","onPreview","onChange"]),i(_,{visible:n.previewVisible,footer:null,onCancel:e[4]||(e[4]=h=>n.previewVisible=!1)},{default:c(()=>[r("img",{alt:"example",style:{width:"100%"},src:n.previewImage},null,8,K)]),_:1},8,["visible"])]),_:1})])]),_:1})],512)]),_:1})]),_:1})}var rt=T(R,[["render",tt],["__scopeId","data-v-3ba719f7"]]);export{rt as default};
