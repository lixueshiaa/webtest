var De=Object.defineProperty,Ne=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var $e=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var ie=(e,c,d)=>c in e?De(e,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[c]=d,w=(e,c)=>{for(var d in c||(c={}))$e.call(c,d)&&ie(e,d,c[d]);if(re)for(var d of re(c))Oe.call(c,d)&&ie(e,d,c[d]);return e},G=(e,c)=>Ne(e,Le(c));var oe=(e,c,d)=>new Promise((g,C)=>{var a=b=>{try{A(d.next(b))}catch(v){C(v)}},p=b=>{try{A(d.throw(b))}catch(v){C(v)}},A=b=>b.done?g(b.value):Promise.resolve(b.value).then(a,p);A((d=d.apply(e,c)).next())});import{cy as Ve,cz as je,cA as Pe,cB as Ue,cC as ze,cD as Ge,cE as He,cF as de,cG as Je,ah as Ze,by as Qe,b6 as R,a as _e,c9 as We,cH as Xe,cI as W,I as Ye,a6 as _,z as ee,f as $,X as H,c as qe,a1 as Re,U as D,o as m,i as j,aa as et,l as N,k as X,G as P,J as ue,t as he,r as tt,p as T,N as te,a9 as nt,ab as ct,ac as lt,bJ as at,aF as st,j as f,ag as fe,cJ as ye,B as ke,b as rt,a7 as L,C as it,c3 as ge,D as be,E as Ke,c4 as ot,cK as pe,ad as Se,cL as ve,bZ as dt,Q as U,aA as ut,a$ as xe,af as Y,cM as ht,b0 as q,b_ as ft,aG as yt}from"./index.9eb451d3.js";import{u as kt}from"./useContextMenu.27080093.js";var gt=200;function bt(e,c,d,g){var C=-1,a=Ue,p=!0,A=e.length,b=[],v=c.length;if(!A)return b;d&&(c=Ve(c,je(d))),g?(a=ze,p=!1):c.length>=gt&&(a=Ge,p=!1,c=new Pe(c));e:for(;++C<A;){var t=e[C],s=d==null?t:d(t);if(t=g||t!==0?t:0,p&&s===s){for(var r=v;r--;)if(c[r]===s)continue e;b.push(t)}else a(c,s,g)||b.push(t)}return b}var Kt=He(function(e,c){return de(e)?bt(e,Je(c,1,de,!0)):[]}),pt=Kt;const St=({icon:e})=>e?Ze(e)?Qe(R,{icon:e,class:"mr-1"}):R:null;const vt=_e({name:"BasicTreeHeader",components:{BasicTitle:We,Icon:R,Dropdown:Xe,Menu:W,MenuItem:W.Item,MenuDivider:W.Divider,InputSearch:Ye.Search},props:{helpMessage:{type:[String,Array],default:""},title:_.string,toolbar:_.bool,checkable:_.bool,search:_.bool,checkAll:_.func,expandAll:_.func,searchText:_.string},emits:["strictly-change","search","clickSearch"],setup(e,{emit:c,slots:d}){const{t:g}=qe(),C=ee(""),a=$(()=>{const t=d.headerTitle||e.title;return["mr-1","w-full",{["ml-5"]:t}]}),p=$(()=>{const{checkable:t}=e,s=[{label:g("component.tree.expandAll"),value:2},{label:g("component.tree.unExpandAll"),value:3,divider:t}];return t?[{label:g("component.tree.selectAll"),value:0},{label:g("component.tree.unSelectAll"),value:1,divider:t},...s,{label:g("component.tree.checkStrictly"),value:4},{label:g("component.tree.checkUnStrictly"),value:5}]:s});function A(t){var r,l,u,i;const{key:s}=t;switch(s){case 0:(r=e.checkAll)==null||r.call(e,!0);break;case 1:(l=e.checkAll)==null||l.call(e,!1);break;case 2:(u=e.expandAll)==null||u.call(e,!0);break;case 3:(i=e.expandAll)==null||i.call(e,!1);break;case 4:c("strictly-change",!1);break;case 5:c("strictly-change",!0);break}}function b(t){c("search",t)}const v=st(b,200);return H(()=>C.value,t=>{v(t)}),H(()=>e.searchText,t=>{t!==C.value&&(C.value=t)}),{t:g,toolbarList:p,handleMenuClick:A,searchValue:C,getInputSearchCls:a}}}),xt={class:"flex px-2 py-1.5 items-center basic-tree-header"},_t={key:2,class:"flex flex-1 justify-end items-center cursor-pointer"};function At(e,c,d,g,C,a){const p=D("BasicTitle"),A=D("InputSearch"),b=D("Icon"),v=D("MenuItem"),t=D("MenuDivider"),s=D("Menu"),r=D("Dropdown");return m(),j("div",xt,[e.$slots.headerTitle?et(e.$slots,"headerTitle",{key:0},void 0,!0):N("",!0),!e.$slots.headerTitle&&e.title?(m(),X(p,{key:1,helpMessage:e.helpMessage},{default:P(()=>[ue(he(e.title),1)]),_:1},8,["helpMessage"])):N("",!0),e.search||e.toolbar?(m(),j("div",_t,[e.search?(m(),j("div",{key:0,class:tt(e.getInputSearchCls)},[T(A,{placeholder:e.t("common.searchText"),size:"small",allowClear:"",value:e.searchValue,"onUpdate:value":c[0]||(c[0]=l=>e.searchValue=l),onSearch:c[1]||(c[1]=l=>e.$emit("clickSearch",l))},null,8,["placeholder","value"])],2)):N("",!0),e.toolbar?(m(),X(r,{key:1,onClick:c[2]||(c[2]=at(()=>{},["prevent"]))},{overlay:P(()=>[T(s,{onClick:e.handleMenuClick},{default:P(()=>[(m(!0),j(te,null,nt(e.toolbarList,l=>(m(),j(te,{key:l.value},[T(v,ct(lt({key:l.value})),{default:P(()=>[ue(he(l.label),1)]),_:2},1040),l.divider?(m(),X(t,{key:0})):N("",!0)],64))),128))]),_:1},8,["onClick"])]),default:P(()=>[T(b,{icon:"ion:ellipsis-vertical"})]),_:1})):N("",!0)])):N("",!0)])}var Ct=Re(vt,[["render",At],["__scopeId","data-v-1c429b3f"]]);function Tt(e,c){function d(t){const s=[],r=t||f(e),{key:l,children:u}=f(c);if(!u||!l)return s;for(let i=0;i<r.length;i++){const o=r[i];s.push(o[l]);const k=o[u];k&&k.length&&s.push(...d(k))}return s}function g(t){const s=[],r=t||f(e),{key:l,children:u}=f(c);if(!u||!l)return s;for(let i=0;i<r.length;i++){const o=r[i];o.disabled!==!0&&o.selectable!==!1&&s.push(o[l]);const k=o[u];k&&k.length&&s.push(...g(k))}return s}function C(t,s){const r=[],l=s||f(e),{key:u,children:i}=f(c);if(!i||!u)return r;for(let o=0;o<l.length;o++){const k=l[o],F=k[i];t===k[u]?(r.push(k[u]),F&&F.length&&r.push(...d(F))):F&&F.length&&r.push(...C(t,F))}return r}function a(t,s,r){if(!t)return;const l=r||f(e),{key:u,children:i}=f(c);if(!(!i||!u))for(let o=0;o<l.length;o++){const k=l[o],F=k[i];if(k[u]===t){l[o]=w(w({},l[o]),s);break}else F&&F.length&&a(t,s,k[i])}}function p(t=1,s,r=1){if(!t)return[];const l=[],u=s||f(e)||[];for(let i=0;i<u.length;i++){const o=u[i],{key:k,children:F}=f(c),J=k?o[k]:"",O=F?o[F]:[];l.push(J),O&&O.length&&r<t&&(r+=1,l.push(...p(t,O,r)))}return l}function A({parentKey:t=null,node:s,push:r="push"}){const l=fe(f(e));if(!t){l[r](s),e.value=l;return}const{key:u,children:i}=f(c);!i||!u||(ye(l,o=>{if(o[u]===t)return o[i]=o[i]||[],o[i][r](s),!0}),e.value=l)}function b({parentKey:t=null,list:s,push:r="push"}){const l=fe(f(e));if(!(!s||s.length<1))if(t){const{key:u,children:i}=f(c);if(!i||!u)return;ye(l,o=>{if(o[u]===t){o[i]=o[i]||[];for(let k=0;k<s.length;k++)o[i][r](s[k]);return e.value=l,!0}})}else for(let u=0;u<s.length;u++)l[r](s[u])}function v(t,s){if(!t)return;const r=s||f(e),{key:l,children:u}=f(c);if(!(!u||!l))for(let i=0;i<r.length;i++){const o=r[i],k=o[u];if(o[l]===t){r.splice(i,1);break}else k&&k.length&&v(t,o[u])}}return{deleteNodeByKey:v,insertNodeByKey:A,insertNodesByKey:b,filterByLevel:p,updateNodeByKey:a,getAllKeys:d,getChildrenKeys:C,getEnabledKeys:g}}const Ft={value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:_.string,toolbar:_.bool,search:_.bool,searchValue:_.string,checkStrictly:_.bool,clickRowToExpand:_.bool.def(!0),checkable:_.bool.def(!1),defaultExpandLevel:{type:[String,Number],default:""},highlight:{type:[Boolean,String],default:!1},defaultExpandAll:_.bool.def(!1),replaceFields:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:null},rightMenuList:{type:Array},filterFn:{type:Function,default:null},expandOnSearch:_.bool.def(!1),checkOnSearch:_.bool.def(!1),selectedOnSearch:_.bool.def(!1)};function Mt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!dt(e)}var It=_e({name:"BasicTree",inheritAttrs:!1,props:Ft,emits:["update:expandedKeys","update:selectedKeys","update:value","change","check","search","update:searchValue"],setup(e,{attrs:c,slots:d,emit:g,expose:C}){const a=ke({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=ke({startSearch:!1,searchData:[]}),A=ee([]),[b]=kt(),{prefixCls:v}=rt("basic-tree"),t=$(()=>{const{replaceFields:n}=e;return w({children:"children",title:"title",key:"key"},n)}),s=$(()=>{let n=G(w(w({blockNode:!0},c),e),{expandedKeys:a.expandedKeys,selectedKeys:a.selectedKeys,checkedKeys:a.checkedKeys,checkStrictly:a.checkStrictly,replaceFields:f(t),"onUpdate:expandedKeys":y=>{a.expandedKeys=y,g("update:expandedKeys",y)},"onUpdate:selectedKeys":y=>{a.selectedKeys=y,g("update:selectedKeys",y)},onCheck:(y,h)=>{let S=U(a.checkedKeys);if(ut(S)&&p.startSearch){const{key:x}=f(t);S=pt(S,O(h.node.$attrs.node[x])),h.checked&&S.push(h.node.$attrs.node[x]),a.checkedKeys=S}else a.checkedKeys=y;const K=U(a.checkedKeys);g("update:value",K),g("check",K,h)},onRightClick:Te});return xe(n,"treeData","class")}),r=$(()=>p.startSearch?p.searchData:f(A)),l=$(()=>!r.value||r.value.length===0),{deleteNodeByKey:u,insertNodeByKey:i,insertNodesByKey:o,filterByLevel:k,updateNodeByKey:F,getAllKeys:J,getChildrenKeys:O,getEnabledKeys:Ae}=Tt(A,t);function Ce(n,y){return!y&&e.renderIcon&&Y(e.renderIcon)?e.renderIcon(n):y}function Te(h){return oe(this,arguments,function*({event:n,node:y}){var E;const{rightMenuList:S=[],beforeRightClick:K}=e;let x={event:n,items:[]};if(K&&Y(K)){let M=yield K(y,n);Array.isArray(M)?x.items=M:Object.assign(x,M)}else x.items=S;!((E=x.items)!=null&&E.length)||b(x)})}function z(n){a.expandedKeys=n}function Fe(){return a.expandedKeys}function Me(n){a.selectedKeys=n}function we(){return a.selectedKeys}function ne(n){a.checkedKeys=n}function Ee(){return a.checkedKeys}function ce(n){a.checkedKeys=n?Ae():[]}function Z(n){a.expandedKeys=n?J():[]}function me(n){a.checkStrictly=n}const B=ee("");L(()=>{e.searchValue!==B.value&&(B.value=e.searchValue)});function Q(n){if(n!==B.value&&(B.value=n),g("update:searchValue",n),!n){p.startSearch=!1;return}const{filterFn:y,checkable:h,expandOnSearch:S,checkOnSearch:K}=f(e);p.startSearch=!0;const{title:x,key:E}=f(t),M=[];p.searchData=ht(f(A),I=>{var ae,se;const V=y?y(n,I,f(t)):(se=(ae=I[x])==null?void 0:ae.includes(n))!=null?se:!1;return V&&M.push(I[E]),V},f(t)),S&&M.length>0&&z(M),K&&h&&M.length>0&&ne(M)}function Be(n,y){if(!(!e.clickRowToExpand||!y||y.length===0))if(!a.expandedKeys.includes(n))z([...a.expandedKeys,n]);else{const h=[...a.expandedKeys],S=h.findIndex(K=>K===n);S!==-1&&h.splice(S,1),z(h)}}L(()=>{A.value=e.treeData,Q(f(B))}),it(()=>{const n=parseInt(e.defaultExpandLevel);n>0?a.expandedKeys=k(n):e.defaultExpandAll&&Z(!0)}),L(()=>{a.expandedKeys=e.expandedKeys}),L(()=>{a.selectedKeys=e.selectedKeys}),L(()=>{a.checkedKeys=e.checkedKeys}),H(()=>e.value,()=>{a.checkedKeys=U(e.value||[])}),H(()=>a.checkedKeys,()=>{const n=U(a.checkedKeys);g("update:value",n),g("change",n)}),L(()=>{a.checkStrictly=e.checkStrictly}),C({setExpandedKeys:z,getExpandedKeys:Fe,setSelectedKeys:Me,getSelectedKeys:we,setCheckedKeys:ne,getCheckedKeys:Ee,insertNodeByKey:i,insertNodesByKey:o,deleteNodeByKey:u,updateNodeByKey:F,checkAll:ce,expandAll:Z,filterByLevel:n=>{a.expandedKeys=k(n)},setSearchValue:n=>{Q(n)},getSearchValue:()=>B.value});function Ie(n){const{actionList:y}=e;if(!(!y||y.length===0))return y.map((h,S)=>{var x;let K=!0;return Y(h.show)?K=(x=h.show)==null?void 0:x.call(h,n):yt(h.show)&&(K=h.show),K?T("span",{key:S,class:`${v}__action`},[h.render(n)]):null})}function le({data:n,level:y}){return n?n.map(h=>{const{title:S,key:K,children:x}=f(t),E=xe(h,"title"),M=Ce(G(w({},h),{level:y}),h.icon),I=q(h,x)||[];return T(pe.TreeNode,Se(E,{node:U(h),key:q(h,K)}),{title:()=>{var V;return T("span",{class:`${v}-title pl-2`,onclick:Be.bind(null,h[K],h[x])},[d!=null&&d.title?ft(d,"title",h):T(te,null,[M&&T(St,{icon:M},null),T("span",{class:(V=f(s))!=null&&V.blockNode?`${v}__content`:""},[q(h,S)]),T("span",{class:`${v}__actions`},[Ie(G(w({},h),{level:y}))])])])},default:()=>le({data:I,level:y+1})})}):null}return()=>{let n;const{title:y,helpMessage:h,toolbar:S,search:K,checkable:x}=e,E=y||S||K||d.headerTitle,M={height:"calc(100% - 38px)"};return T("div",{class:[v,"h-full",c.class]},[E&&T(Ct,{checkable:x,checkAll:ce,expandAll:Z,title:y,search:K,toolbar:S,helpMessage:h,onStrictlyChange:me,onSearch:Q,onClickSearch:I=>g("search",I),searchText:f(B)},Mt(n=ge(d))?n:{default:()=>[n]}),be(T(ot,{style:M},{default:()=>[T(pe,Se(f(s),{showIcon:!1}),w({default:()=>le({data:f(r),level:1})},ge(d)))]}),[[Ke,!f(l)]]),be(T(ve,{image:ve.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[Ke,f(l)]])])}}});export{It as _};
