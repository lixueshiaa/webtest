var M=Object.defineProperty;var _=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var S=(e,r,t)=>r in e?M(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,B=(e,r)=>{for(var t in r||(r={}))P.call(r,t)&&S(e,t,r[t]);if(_)for(var t of _(r))k.call(r,t)&&S(e,t,r[t]);return e};var v=(e,r,t)=>new Promise((s,p)=>{var h=a=>{try{n(t.next(a))}catch(i){p(i)}},j=a=>{try{n(t.throw(a))}catch(i){p(i)}},n=a=>a.done?s(a.value):Promise.resolve(a.value).then(h,j);n((t=t.apply(e,r)).next())});import{B as A}from"./index.f8f2ddf0.js";import{B as L}from"./BasicForm.74bae903.js";import"./componentMap.bdddb878.js";import{u as O}from"./useForm.0a8b633b.js";import"./RadioButtonGroup.e396598a.js";import{a0 as l,bR as R,a as J,z as N,bg as V,j as u,f as z,U as f,o as G,k as H,G as d,p as c,ad as K,J as Q,T as W}from"./index.6cf4d174.js";import"./JDictSelectTag.77cd1e49.js";import"./JUpload.a8971a82.js";const X={1:{dbDriver:"com.mysql.jdbc.Driver"},4:{dbDriver:"com.mysql.cj.jdbc.Driver"},2:{dbDriver:"oracle.jdbc.OracleDriver"},3:{dbDriver:"com.microsoft.sqlserver.jdbc.SQLServerDriver"},5:{dbDriver:"org.mariadb.jdbc.Driver"},6:{dbDriver:"org.postgresql.Driver"},7:{dbDriver:"dm.jdbc.driver.DmDriver"},8:{dbDriver:"com.kingbase8.Driver"},9:{dbDriver:"com.oscar.Driver"},10:{dbDriver:"org.sqlite.JDBC"},11:{dbDriver:"com.ibm.db2.jcc.DB2Driver"},12:{dbDriver:"org.hsqldb.jdbc.JDBCDriver"},13:{dbDriver:"org.apache.derby.jdbc.ClientDriver"},14:{dbDriver:"org.h2.Driver"},15:{dbDriver:""}},$={1:{dbUrl:"jdbc:mysql://127.0.0.1:3306/jeecg-boot?characterEncoding=UTF-8&useUnicode=true&useSSL=false"},4:{dbUrl:"jdbc:mysql://127.0.0.1:3306/jeecg-boot?characterEncoding=UTF-8&useUnicode=true&useSSL=false&tinyInt1isBit=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Shanghai"},2:{dbUrl:"jdbc:oracle:thin:@127.0.0.1:1521:ORCL"},3:{dbUrl:"jdbc:sqlserver://127.0.0.1:1433;SelectMethod=cursor;DatabaseName=jeecgboot"},5:{dbUrl:"jdbc:mariadb://127.0.0.1:3306/jeecg-boot?characterEncoding=UTF-8&useSSL=false"},6:{dbUrl:"jdbc:postgresql://127.0.0.1:5432/jeecg-boot"},7:{dbUrl:"jdbc:dm://127.0.0.1:5236/?jeecg-boot&zeroDateTimeBehavior=convertToNull&useUnicode=true&characterEncoding=utf-8"},8:{dbUrl:"jdbc:kingbase8://127.0.0.1:54321/jeecg-boot"},9:{dbUrl:"jdbc:oscar://192.168.1.125:2003/jeecg-boot"},10:{dbUrl:"jdbc:sqlite://opt/test.db"},11:{dbUrl:"jdbc:db2://127.0.0.1:50000/jeecg-boot"},12:{dbUrl:"jdbc:hsqldb:hsql://127.0.0.1/jeecg-boot"},13:{dbUrl:"jdbc:derby://127.0.0.1:1527/jeecg-boot"},14:{dbUrl:"jdbc:h2:tcp://127.0.0.1:8082/jeecg-boot"},15:{dbUrl:""}},pe=[{title:"\u6570\u636E\u6E90\u540D\u79F0",dataIndex:"name",width:200,align:"left"},{title:"\u6570\u636E\u5E93\u7C7B\u578B",dataIndex:"dbType_dictText",width:200},{title:"\u9A71\u52A8\u7C7B",dataIndex:"dbDriver",width:200},{title:"\u6570\u636E\u6E90\u5730\u5740",dataIndex:"dbUrl"},{title:"\u7528\u6237\u540D",dataIndex:"dbUsername",width:200}],me=[{field:"name",label:"\u6570\u636E\u6E90\u540D\u79F0",component:"Input",colProps:{span:8}},{field:"dbType",label:"\u6570\u636E\u5E93\u7C7B\u578B",component:"JDictSelectTag",colProps:{span:8},componentProps:()=>({dictCode:"database_type"})}],Y=[{field:"id",label:"id",component:"Input",show:!1},{field:"code",label:"\u6570\u636E\u6E90\u7F16\u7801",component:"Input",required:!0,dynamicDisabled:({values:e})=>!!e.id},{field:"name",label:"\u6570\u636E\u6E90\u540D\u79F0",component:"Input",required:!0},{field:"dbType",label:"\u6570\u636E\u5E93\u7C7B\u578B",component:"JDictSelectTag",required:!0,componentProps:({formModel:e})=>({dictCode:"database_type",onChange:r=>{e=Object.assign(e,X[r],$[r])}})},{field:"dbDriver",label:"\u9A71\u52A8\u7C7B",required:!0,component:"Input"},{field:"dbUrl",label:"\u6570\u636E\u6E90\u5730\u5740",required:!0,component:"Input"},{field:"dbUsername",label:"\u7528\u6237\u540D",required:!0,component:"Input"},{field:"dbPassword",label:"\u5BC6\u7801",required:!0,component:"InputPassword",slot:"pwd"},{field:"remark",label:"\u5907\u6CE8",component:"InputTextArea"}],De="sys/dataSource/exportXls",ge="sys/dataSource/importExcel",ve=e=>l.get({url:"/sys/dataSource/list",params:e}),Z=(e,r)=>{let t=r?"/sys/dataSource/edit":"/sys/dataSource/add";return l.post({url:t,params:e})},ee=e=>l.get({url:"/sys/dataSource/queryById",params:e}),fe=(e,r)=>l.delete({url:"/sys/dataSource/delete",data:e},{joinParamsToUrl:!0}).then(()=>{r()}),re=e=>l.post({url:"/online/cgreport/api/testConnection",params:e}),he=(e,r)=>{R.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u662F\u5426\u5220\u9664\u9009\u4E2D\u6570\u636E",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:()=>l.delete({url:"/sys/dataSource/deleteBatch",data:e},{joinParamsToUrl:!0}).then(()=>{r()})})},te=Q("\u6D4B\u8BD5"),oe=J({__name:"DataSourceModal",emits:["register","success"],setup(e,{emit:r}){const{createMessage:t}=W(),s=N(!0),[p,{getFieldsValue:h,resetFields:j,validateFields:n,setFieldsValue:a,validate:i}]=O({labelWidth:150,schemas:Y,showActionButtonGroup:!1}),[w,{setModalProps:y,closeModal:F}]=V(o=>v(this,null,function*(){yield j(),y({confirmLoading:!1}),s.value=!!(o!=null&&o.isUpdate),u(s)&&(o.record=yield ee({id:o.record.id}),yield a(B({},o.record)))})),T=z(()=>u(s)?"\u7F16\u8F91\u6570\u636E\u6E90":"\u65B0\u589E\u6570\u636E\u6E90");function q(){return v(this,null,function*(){let o=["dbType","dbDriver","dbUrl","dbName","dbUsername","dbPassword"],m=h(o);o.forEach(b=>({value:m[b],errors:null})),yield n(o).then(b=>{let D=t.loading("\u8FDE\u63A5\u4E2D....",0);re(b).then(g=>{g.success&&t.success("\u8FDE\u63A5\u6210\u529F")}).catch(g=>{}).finally(()=>D())})})}function C(o){return v(this,null,function*(){try{let m=yield i();y({confirmLoading:!0}),yield Z(m,s.value),F(),r("success")}finally{y({confirmLoading:!1})}})}return(o,m)=>{const b=f("a-input-password"),D=f("a-col"),g=f("a-button"),I=f("a-row");return G(),H(u(A),K(o.$attrs,{onRegister:u(w),title:u(T),onOk:C,width:"40%"}),{default:d(()=>[c(u(L),{onRegister:u(p)},{pwd:d(({model:E,field:U})=>[c(I,{gutter:8},{default:d(()=>[c(D,{sm:15,md:16,lg:17,xl:19},{default:d(()=>[c(b,{value:E[U],"onUpdate:value":x=>E[U]=x,placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["value","onUpdate:value"])]),_:2},1024),c(D,{sm:9,md:7,lg:7,xl:5},{default:d(()=>[c(g,{type:"primary",style:{width:"100%"},onClick:q},{default:d(()=>[te]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"])}}});var je=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"}));export{je as D,oe as _,De as a,ge as b,pe as c,fe as d,he as e,ve as g,me as s};
