var A=Object.defineProperty,D=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var V=(n,t,e)=>t in n?A(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,h=(n,t)=>{for(var e in t||(t={}))L.call(t,e)&&V(n,e,t[e]);if(w)for(var e of w(t))S.call(t,e)&&V(n,e,t[e]);return n},m=(n,t)=>D(n,T(t));var v=(n,t,e)=>new Promise((y,p)=>{var i=o=>{try{f(e.next(o))}catch(c){p(c)}},u=o=>{try{f(e.throw(o))}catch(c){p(c)}},f=o=>o.done?y(o.value):Promise.resolve(o.value).then(i,u);f((e=e.apply(n,t)).next())});import{a as j,a6 as s,b as P,a_ as B,z as R,X as k,a0 as K,o as H,k as I,ad as z,j as _,b3 as F}from"./index.d537950e.js";const q=j({__name:"NebeTreeSelect",props:{value:s.string.def(""),parentCodeRootValue:s.string.def(""),parentCodeKey:s.string.def("parentCode"),valueKey:s.string.def("value"),labelKey:s.string.def("label"),childrenKey:s.string.def("children"),isLeafKey:s.string.def("isLeaf"),async:s.bool.def(!1),viewApi:s.string.def(""),rootApi:s.string.def("")},emits:["change","update:value"],setup(n,{emit:t}){const e=n,{prefixCls:y}=P("j-tree-dict"),p=B(),i=R([]),u=R(null);k(()=>e.value,()=>f(),{deep:!0,immediate:!0}),k(()=>e.parentCodeRootValue,()=>o(),{deep:!0,immediate:!0});function f(){return v(this,null,function*(){if(!e.value||e.value=="0")u.value=null;else{let a={[e.valueKey]:e.value},l=yield K.get({url:e.viewApi,params:a});Array.isArray(l)?u.value=m(h({},l),{value:e.value,label:l.map(r=>r[e.labelKey]).join(",")}):u.value=m(h({},l),{value:e.value,label:l[e.labelKey]})}})}function o(){return v(this,null,function*(){let a={[e.parentCodeKey]:e.parentCodeRootValue},l=yield K.get({url:e.rootApi,params:a});i.value=[...l],g(l)})}function c(a){return v(this,null,function*(){if(!e.async||a.dataRef.children&&a.dataRef.children.length)return Promise.resolve();let l=a.dataRef.key,r={[e.parentCodeKey]:l},d=yield K.get({url:e.rootApi,params:r});return g(d),b(l,d,i.value),i.value=[...i.value],Promise.resolve()})}function b(a,l,r){if(r&&r.length>0)for(let d of r)if(d.key==a){!l||l.length==0?d.leaf=!0:d.children=l;break}else b(a,l,d.children)}function g(a){let l=e.valueKey;for(let r of a)r.value=r[l],r.isLeaf=r[e.isLeafKey],r[e.childrenKey]&&r[e.childrenKey].length>0&&g(r[e.childrenKey])}function x(a){C(a?a.value:""),u.value=a}function C(a){t("change",u.value),t("update:value",a)}return(a,l)=>(H(),I(_(F),z({class:_(y),value:u.value,treeData:i.value,loadData:c,allowClear:"",labelInValue:"",dropdownStyle:{maxHeight:"400px",overflow:"auto"},style:{width:"100%"}},_(p),{onChange:x}),null,16,["class","value","treeData"]))}});export{q as default};
