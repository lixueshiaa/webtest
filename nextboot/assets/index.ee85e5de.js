var ge=Object.defineProperty,Be=Object.defineProperties;var Fe=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var Z=(n,t,o)=>t in n?ge(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,ee=(n,t)=>{for(var o in t||(t={}))Ce.call(t,o)&&Z(n,o,t[o]);if(Y)for(var o of Y(t))he.call(t,o)&&Z(n,o,t[o]);return n},ne=(n,t)=>Be(n,Fe(t));var h=(n,t,o)=>new Promise((m,b)=>{var r=l=>{try{_(o.next(l))}catch(F){b(F)}},f=l=>{try{_(o.throw(l))}catch(F){b(F)}},_=l=>l.done?m(l.value):Promise.resolve(l.value).then(r,f);_((o=o.apply(n,t)).next())});import{B as we}from"./BasicTable.1032ab26.js";import{T as be}from"./componentMap.6942b0b6.js";import"./TableImg.39540c6d.js";import Ee from"./UserDrawer.6fbaaa03.js";import Ae from"./UserRecycleBinModal.cede3629.js";import ke from"./PasswordModal.22795b5c.js";import Te from"./UserAgentModal.3ccb26b7.js";import{a as J,U as B,o as d,k as w,G as a,p as s,J as p,t as P,l as R,a1 as De,z as re,f as te,bR as W,fH as ve,a0 as xe,by as H,i as q,ad as oe,fI as ue,j as u,N as se,T as le,bj as X,c7 as Se,D as Re}from"./index.9eb451d3.js";import{u as $e}from"./index.cd36df4e.js";import{u as Ie}from"./useListPage.b997c0e2.js";import"./index.9788db2e.js";import{c as Me,s as Le}from"./user.data.069fcdda.js";import{l as je,e as ze,f as Ue,h as Pe,i as ae,j as He}from"./user.api.c26e46a3.js";import"./BasicForm.d1b5a4f4.js";import"./FormItem.vue_vue_type_script_lang.1dbd23cc.js";import"./BasicModal.a7306b6e.js";import"./useWindowSizeFn.ed181042.js";import"./useForm.26fd4105.js";import"./RadioButtonGroup.6d9641c3.js";import"./useFormItem.b38dda7e.js";import"./JDictSelectTag.3b1f5a5e.js";import"./JUpload.38683df0.js";import"./api.632a718d.js";import"./functional.8b995981.js";import"./index.83e82d5a.js";import"./onMountedOrActivated.bab7e2a6.js";import"./useContentViewHeight.0d594355.js";import"./FormOutlined.22ab579b.js";import"./useSortable.043e591f.js";import"./index.5df19bc8.js";import"./download.de7e8375.js";import"./base64Conver.bb012c73.js";import"./index.509a06e4.js";import"./index.dd61c578.js";import"./useCountdown.71e244f9.js";import"./props.d56cca40.js";import"./Tree.vue_vue_type_style_index_0_lang.1f840683.js";import"./useContextMenu.27080093.js";import"./index.e63dfd63.js";import"./index.c61598b5.js";import"./htmlmixed.95cdf531.js";import"./vue.e841ff5e.js";import"./depart.api.03e31315.js";import"./index.5fc45d81.js";import"./EditOutlined.1cd3ad58.js";import"./validator.cd75231b.js";import"./useTable.44d02b40.js";const Je={getEnabledType:"/sys/thirdApp/getEnabledType",wechatEnterprise:{user:"/sys/thirdApp/sync/wechatEnterprise/user",depart:"/sys/thirdApp/sync/wechatEnterprise/depart"},dingtalk:{user:"/sys/thirdApp/sync/dingtalk/user",depart:"/sys/thirdApp/sync/dingtalk/depart"}},Ke=()=>h(void 0,null,function*(){return{}}),Ne=p("\u540C\u6B65\u5230\u672C\u5730"),ie=J({__name:"JThirdAppDropdown",props:{type:String,name:String,syncToApp:Boolean,syncToLocal:Boolean},emits:["to-app","to-local"],setup(n,{emit:t}){const o=n;function m(b){t(b.key,{type:o.type})}return(b,r)=>{const f=B("a-button"),_=B("a-menu-item"),l=B("a-menu"),F=B("a-dropdown");return n.syncToApp&&n.syncToLocal?(d(),w(F,{key:0},{overlay:a(()=>[s(l,{onClick:m},{default:a(()=>[n.syncToApp?(d(),w(_,{key:"to-app"},{default:a(()=>[p("\u540C\u6B65\u5230"+P(n.name),1)]),_:1})):R("",!0),n.syncToLocal?(d(),w(_,{key:"to-local"},{default:a(()=>[Ne]),_:1})):R("",!0)]),_:1})]),default:a(()=>[s(f,{type:"primary",preIcon:"ant-design:sync-outlined"},{default:a(()=>[p("\u540C\u6B65"+P(n.name),1)]),_:1})]),_:1})):n.syncToApp?(d(),w(f,{key:1,type:"primary",preIcon:"ant-design:sync-outlined",onClick:r[0]||(r[0]=k=>m({key:"to-app"}))},{default:a(()=>[p("\u540C\u6B65"+P(n.name),1)]),_:1})):(d(),w(f,{key:2,type:"primary",preIcon:"ant-design:sync-outlined",onClick:r[1]||(r[1]=k=>m({key:"to-local"}))},{default:a(()=>[p("\u540C\u6B65"+P(n.name)+"\u5230\u672C\u5730",1)]),_:1}))}}});const Oe=p("\u672A\u8BBE\u7F6E\u4EFB\u4F55\u540C\u6B65\u65B9\u5411"),Ve=J({__name:"JThirdAppButton",props:{bizType:{type:String,required:!0},syncToApp:Boolean,syncToLocal:Boolean,selectedRowKeys:Array},emits:["sync-ok","sync-error","sync-finally"],setup(n,{emit:t}){const o=n,{createMessage:m,createWarningModal:b}=le(),r=re({}),f=te(()=>({syncToApp:o.syncToApp,syncToLocal:o.syncToLocal})),_=te(()=>({"to-app":l,"to-local":F}));function l(y){$(y.type,"/toApp")}function F(y){$(y.type,"/toLocal")}function k(){return h(this,null,function*(){r.value=yield Ke()})}function $(y,C){let T=Je[y];if(!(T&&T[o.bizType])){console.warn("\u914D\u7F6E\u51FA\u9519");return}let N=T[o.bizType]+C,i=o.selectedRowKeys,I="\u786E\u5B9A\u8981\u5F00\u59CB\u540C\u6B65\u5168\u90E8\u6570\u636E\u5417\uFF1F\u53EF\u80FD\u82B1\u8D39\u8F83\u957F\u65F6\u95F4\uFF01";return Array.isArray(i)&&i.length>0?I=`\u786E\u5B9A\u8981\u5F00\u59CB\u540C\u6B65\u8FD9 ${i.length} \u9879\u5417\uFF1F`:i=[],new Promise((M,A)=>{const L=W.confirm({icon:s(ve),title:"\u540C\u6B65",content:I,onOk:()=>{L.update({keyboard:!1,okText:"\u540C\u6B65\u4E2D\u2026",cancelButtonProps:{disabled:!0}});let O={ids:i.join(",")};return xe.get({url:N,params:O},{isTransformResponse:!1}).then(g=>{let E={};g.result&&(E={width:600,title:g.message,content:()=>{let D,j=["\u6210\u529F\u4FE1\u606F\u5982\u4E0B\uFF1A",K(H,g.result.successInfo.map((v,x)=>`${x+1}. ${v}`).join(`
`))];return g.success?D=[...j,H("br"),"\u65E0\u5931\u8D25\u4FE1\u606F\uFF01"]:D=["\u5931\u8D25\u4FE1\u606F\u5982\u4E0B\uFF1A",K(H,g.result.failInfo.map((v,x)=>`${x+1}. ${v}`).join(`
`)),H("br"),...j],D}}),g.success?(E!=null?W.success(E):m.warning(g.message),t("sync-ok")):(E!=null?W.warning(E):m.warning(g.message),t("sync-error"))}).catch(()=>L.destroy()).finally(()=>{M(),t("sync-finally",{type:y,direction:C,isToApp:C==="/toApp",isToLocal:C==="/toLocal"})})},onCancel(){M()}})})}function K(y,C){return y("div",{id:"box",style:{minHeight:"100px",border:"1px solid #d9d9d9",fontSize:"14px",maxHeight:"250px",whiteSpace:"pre",overflow:"auto",padding:"10px"}},C)}return k(),(y,C)=>n.syncToApp||n.syncToLocal?(d(),q(se,{key:0},[r.value.wechatEnterprise?(d(),w(ie,oe({key:0,type:"wechatEnterprise",name:"\u4F01\u5FAE"},u(f),ue(u(_))),null,16)):R("",!0),r.value.dingtalk?(d(),w(ie,oe({key:1,type:"dingtalk",name:"\u9489\u9489"},u(f),ue(u(_))),null,16)):R("",!0)],64)):(d(),q(se,{key:1},[Oe],64))}});var We=De(Ve,[["__scopeId","data-v-6d412c44"]]);const Xe=p(" \u65B0\u589E"),qe=p(" \u5BFC\u51FA"),Ge=p("\u5BFC\u5165"),Qe=p(" \u5220\u9664 "),Ye=p(" \u51BB\u7ED3 "),Ze=p(" \u89E3\u51BB "),en=p("\u6279\u91CF\u64CD\u4F5C "),nn=J({name:"system-user"}),Qn=J(ne(ee({},nn),{setup(n){const{createMessage:t,createConfirm:o}=le(),m=re([]),[b,{openDrawer:r}]=$e(),[f,{openModal:_}]=X(),[l,{openModal:F}]=X(),[k,{openModal:$}]=X(),{prefixCls:K,tableContext:y,onExportXls:C,onImportXls:T}=Ie({designScope:"user-list",tableProps:{title:"\u7528\u6237\u5217\u8868",api:je,columns:Me,size:"small",formConfig:{labelWidth:200,schemas:Le},actionColumn:{width:120},beforeFetch:e=>Object.assign({column:"createTime",order:"desc"},e)},exportConfig:{name:"\u7528\u6237\u5217\u8868",url:ze},importConfig:{url:Ue}}),[N,{reload:i,updateTableDataRecord:I},{rowSelection:M,selectedRowKeys:A}]=y;function L(){r(!0,{isUpdate:!1,showFooter:!0})}function O(e){return h(this,null,function*(){r(!0,{record:e,isUpdate:!0,showFooter:!0})})}function g(e){return h(this,null,function*(){r(!0,{record:e,isUpdate:!0,showFooter:!1,action:"detail"})})}function E(e){return h(this,null,function*(){if(e.username=="admin"){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}yield He({id:e.id},i)})}function D(){return h(this,null,function*(){let e=u(m).filter(c=>c.username=="admin");if(u(e).length>0){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}yield Pe({ids:A.value},()=>{A.value=[],i()})})}function j({isUpdate:e,values:c}){e?I(c.id,c):i()}function v(e){F(!0,{username:e})}function x(e){$(!0,{userName:e})}function G(e,c){return h(this,null,function*(){if(e.username=="admin"){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}yield ae({ids:e.id,status:c},i)})}function Q(e){let c=u(m).filter(S=>S.username=="admin");if(u(c).length>0){t.warning("\u7BA1\u7406\u5458\u8D26\u53F7\u4E0D\u5141\u8BB8\u6B64\u64CD\u4F5C\uFF01");return}o({iconType:"warning",title:"\u786E\u8BA4\u64CD\u4F5C",content:"\u662F\u5426"+(e==1?"\u89E3\u51BB":"\u51BB\u7ED3")+"\u9009\u4E2D\u8D26\u53F7?",onOk:()=>h(this,null,function*(){yield ae({ids:u(A).join(","),status:e},i)})})}function ce({isToLocal:e}){e&&i()}function pe(e){return[{label:"\u7F16\u8F91",onClick:O.bind(null,e)}]}function de(e){return[{label:"\u8BE6\u60C5",onClick:g.bind(null,e)},{label:"\u5BC6\u7801",onClick:v.bind(null,e.username)},{label:"\u5220\u9664",popConfirm:{title:"\u662F\u5426\u786E\u8BA4\u5220\u9664",confirm:E.bind(null,e)}},{label:"\u51BB\u7ED3",ifShow:e.status==1,popConfirm:{title:"\u786E\u5B9A\u51BB\u7ED3\u5417?",confirm:G.bind(null,e,2)}},{label:"\u89E3\u51BB",ifShow:e.status==2,popConfirm:{title:"\u786E\u5B9A\u89E3\u51BB\u5417?",confirm:G.bind(null,e,1)}},{label:"\u4EE3\u7406\u4EBA",onClick:x.bind(null,e.username)}]}return(e,c)=>{const S=B("a-button"),me=B("j-upload-button"),z=B("Icon"),V=B("a-menu-item"),ye=B("a-menu"),fe=B("a-dropdown"),_e=Se("auth");return d(),q("div",null,[s(u(we),{onRegister:u(N),rowSelection:u(M)},{tableTitle:a(()=>[Re((d(),w(S,{type:"primary",preIcon:"ant-design:plus-outlined",onClick:L},{default:a(()=>[Xe]),_:1})),[[_e,"user:add"]]),s(S,{type:"primary",preIcon:"ant-design:export-outlined",onClick:u(C)},{default:a(()=>[qe]),_:1},8,["onClick"]),s(me,{type:"primary",preIcon:"ant-design:import-outlined",onClick:u(T)},{default:a(()=>[Ge]),_:1},8,["onClick"]),s(We,{"biz-type":"user","selected-row-keys":u(A),syncToApp:"",syncToLocal:"",onSyncFinally:ce},null,8,["selected-row-keys"]),u(A).length>0?(d(),w(fe,{key:0},{overlay:a(()=>[s(ye,null,{default:a(()=>[s(V,{key:"1",onClick:D},{default:a(()=>[s(z,{icon:"ant-design:delete-outlined"}),Qe]),_:1}),s(V,{key:"2",onClick:c[0]||(c[0]=U=>Q(2))},{default:a(()=>[s(z,{icon:"ant-design:lock-outlined"}),Ye]),_:1}),s(V,{key:"3",onClick:c[1]||(c[1]=U=>Q(1))},{default:a(()=>[s(z,{icon:"ant-design:unlock-outlined"}),Ze]),_:1})]),_:1})]),default:a(()=>[s(S,null,{default:a(()=>[en,s(z,{icon:"mdi:chevron-down"})]),_:1})]),_:1})):R("",!0)]),action:a(({record:U})=>[s(u(be),{actions:pe(U),dropDownActions:de(U)},null,8,["actions","dropDownActions"])]),_:1},8,["onRegister","rowSelection"]),s(Ee,{onRegister:u(b),onSuccess:j},null,8,["onRegister"]),s(ke,{onRegister:u(l),onSuccess:u(i)},null,8,["onRegister","onSuccess"]),s(Te,{onRegister:u(k),onSuccess:u(i)},null,8,["onRegister","onSuccess"]),s(Ae,{onRegister:u(f),onSuccess:u(i)},null,8,["onRegister","onSuccess"])])}}}));export{Qn as default};
